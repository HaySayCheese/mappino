{"version":3,"sources":["angular-file-upload.js"],"names":["patchXHR","fnName","newFn","window","XMLHttpRequest","prototype","redefineProp","xhr","prop","fn","Object","defineProperty","get","e","FileAPI","shouldLoad","FormData","forceLoad","initializeUploadListener","__listeners","upload","origAddEventListener","addEventListener","t","apply","this","arguments","orig","m","url","b","__url","message","indexOf","__origError","h","__fileApiXHR","getResponseHeader","getAllResponseHeaders","abort","header","value","val","Function","__requestHeaders","__isFileAPIShim","formData","config","jsonp","cache","complete","err","fileApiXHR","__completed","load","type","loaded","__loaded","total","__total","target","lengthComputable","loadend","undefined","status","statusText","response","resp","responseText","onreadystatechange","onload","progress","_this","setTimeout","noContentTimeout","headers","data","files","i","length","item","name","size","key","hasFlash","append","__isFileAPIBlobShim","push","Blob","isInputTypeFile","elem","tagName","toLowerCase","attr","fo","ActiveXObject","navigator","mimeTypes","getOffset","obj","left","top","jQuery","offset","offsetParent","offsetLeft","scrollLeft","offsetTop","scrollTop","html5","jsUrl","basePath","index","src","script","document","createElement","allScripts","getElementsByTagName","jsPath","search","substring","staticPath","setAttribute","appendChild","ngfFixIE","createFileElemFn","bindAttr","changeFn","makeFlashInput","$$ngfRefElem","removeClass","fileElem","addClass","bind","evt","fileApiChangeFn","css","offsetWidth","offsetHeight","getFiles","__files_","disableFileInput","disable","FileReader","loadStarted","listeners","removeEventListener","splice","dispatchEvent","list","call","onabort","onerror","onloadstart","onloadend","onprogress","constructEvent","error","result","listener","readAsArrayBuffer","file","readAsBinaryString","readAsDataURL","readAsText","setRequestHeader","ngFileUpload","angular","module","version","defaults","service","$http","$q","$timeout","sendHttp","method","deferred","defer","promise","__setXHR_","__XHR","xhrFn","notify","progressFunc","then","r","resolve","reject","n","success","update","origXhrFn","addFieldToFormData","isDate","toISOString","isString","sendFieldsAs","isObject","k","hasOwnProperty","JSON","stringify","transformRequest","isArray","allFields","fields","formDataAppender","fileFormName","fileFormDataName","isFileFormNameString","fileName","http","ArrayBuffer","dataUrl","callback","disallowObjectUrl","userAgent","URL","webkitURL","createObjectURL","fileReader","setDefaults","linkFileSelect","scope","ngModel","$parse","$compile","isUpdating","fileList","rejFiles","validate","updateModel","getAttr","bindAttrToFileInput","attributes","attribute","createFileInput","resetOnClick","element","replaceWith","remove","body","resetModel","clickHandler","clickAndAssign","clientY","click","disabled","initialTouchStartY","originalEvent","touches","stopPropagation","preventDefault","currentLocation","changedTouches","Math","abs","shouldClickLater","$on","$watch","ua","match","v","androidFixMinorVersion","parseInt","test","getAttrWithDefaults","toString","directive","restrict","require","link","globStringToRegex","str","split","replace","RegExp","accept","$file","$event","fileSizeMax","fileSizeMin","regexp","$error","fileChange","noDelay","keep","prevFiles","$modelValue","slice","len","j","concat","singleModel","assign","$setViewValue","ngfModel","$files","$rejectedFiles","linkDrop","$location","calculateDragOverClass","accepted","items","dataTransfer","kind","clazz","delay","dragOverDelay","extractFiles","allowDir","multiple","addFile","traverseFileTree","entry","path","isDirectory","filePath","dirReader","createReader","entries","processing","readEntries","results","Array","console","protocol","webkitGetAsEntry","f","getAsFile","delays","waitForProcess","available","dropAvailable","actualDragOverClass","leaveTimeout","effectAllowed","dropEffect","cancel","div","fileToSrc","Upload","defaultName","ngfNoObjectUrl","ngfSrc","ngfDefaultSrc","ngfBackground","ngfDefaultBackground","ngfDataUrl","ngfDefaultDataUrl"],"mappings":"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","file":"angular-file-upload.js","sourcesContent":["/**!\n * AngularJS file upload/drop directive and service with progress and abort\n * FileAPI Flash shim for old browsers not supporting FormData\n * @author  Danial  <danial.farid@gmail.com>\n * @version 6.0.2\n */\n\n(function () {\n    /** @module FileAPI.noContentTimeout */\n\n    function patchXHR(fnName, newFn) {\n        window.XMLHttpRequest.prototype[fnName] = newFn(window.XMLHttpRequest.prototype[fnName]);\n    }\n\n    function redefineProp(xhr, prop, fn) {\n        try {\n            Object.defineProperty(xhr, prop, {get: fn});\n        } catch (e) {/*ignore*/\n        }\n    }\n\n    if (!window.FileAPI) {\n        window.FileAPI = {};\n    }\n\n    FileAPI.shouldLoad = (window.XMLHttpRequest && !window.FormData) || FileAPI.forceLoad;\n    if (FileAPI.shouldLoad) {\n        var initializeUploadListener = function (xhr) {\n            if (!xhr.__listeners) {\n                if (!xhr.upload) xhr.upload = {};\n                xhr.__listeners = [];\n                var origAddEventListener = xhr.upload.addEventListener;\n                xhr.upload.addEventListener = function (t, fn) {\n                    xhr.__listeners[t] = fn;\n                    if (origAddEventListener) origAddEventListener.apply(this, arguments);\n                };\n            }\n        };\n\n        patchXHR('open', function (orig) {\n            return function (m, url, b) {\n                initializeUploadListener(this);\n                this.__url = url;\n                try {\n                    orig.apply(this, [m, url, b]);\n                } catch (e) {\n                    if (e.message.indexOf('Access is denied') > -1) {\n                        this.__origError = e;\n                        orig.apply(this, [m, '_fix_for_ie_crossdomain__', b]);\n                    }\n                }\n            };\n        });\n\n        patchXHR('getResponseHeader', function (orig) {\n            return function (h) {\n                return this.__fileApiXHR && this.__fileApiXHR.getResponseHeader ? this.__fileApiXHR.getResponseHeader(h) : (orig == null ? null : orig.apply(this, [h]));\n            };\n        });\n\n        patchXHR('getAllResponseHeaders', function (orig) {\n            return function () {\n                return this.__fileApiXHR && this.__fileApiXHR.getAllResponseHeaders ? this.__fileApiXHR.getAllResponseHeaders() : (orig == null ? null : orig.apply(this));\n            };\n        });\n\n        patchXHR('abort', function (orig) {\n            return function () {\n                return this.__fileApiXHR && this.__fileApiXHR.abort ? this.__fileApiXHR.abort() : (orig == null ? null : orig.apply(this));\n            };\n        });\n\n        patchXHR('setRequestHeader', function (orig) {\n            return function (header, value) {\n                if (header === '__setXHR_') {\n                    initializeUploadListener(this);\n                    var val = value(this);\n                    // fix for angular < 1.2.0\n                    if (val instanceof Function) {\n                        val(this);\n                    }\n                } else {\n                    this.__requestHeaders = this.__requestHeaders || {};\n                    this.__requestHeaders[header] = value;\n                    orig.apply(this, arguments);\n                }\n            };\n        });\n\n        patchXHR('send', function (orig) {\n            return function () {\n                var xhr = this;\n                if (arguments[0] && arguments[0].__isFileAPIShim) {\n                    var formData = arguments[0];\n                    var config = {\n                        url: xhr.__url,\n                        jsonp: false, //removes the callback form param\n                        cache: true, //removes the ?fileapiXXX in the url\n                        complete: function (err, fileApiXHR) {\n                            xhr.__completed = true;\n                            if (!err && xhr.__listeners.load)\n                                xhr.__listeners.load({\n                                    type: 'load',\n                                    loaded: xhr.__loaded,\n                                    total: xhr.__total,\n                                    target: xhr,\n                                    lengthComputable: true\n                                });\n                            if (!err && xhr.__listeners.loadend)\n                                xhr.__listeners.loadend({\n                                    type: 'loadend',\n                                    loaded: xhr.__loaded,\n                                    total: xhr.__total,\n                                    target: xhr,\n                                    lengthComputable: true\n                                });\n                            if (err === 'abort' && xhr.__listeners.abort)\n                                xhr.__listeners.abort({\n                                    type: 'abort',\n                                    loaded: xhr.__loaded,\n                                    total: xhr.__total,\n                                    target: xhr,\n                                    lengthComputable: true\n                                });\n                            if (fileApiXHR.status !== undefined) redefineProp(xhr, 'status', function () {\n                                return (fileApiXHR.status === 0 && err && err !== 'abort') ? 500 : fileApiXHR.status;\n                            });\n                            if (fileApiXHR.statusText !== undefined) redefineProp(xhr, 'statusText', function () {\n                                return fileApiXHR.statusText;\n                            });\n                            redefineProp(xhr, 'readyState', function () {\n                                return 4;\n                            });\n                            if (fileApiXHR.response !== undefined) redefineProp(xhr, 'response', function () {\n                                return fileApiXHR.response;\n                            });\n                            var resp = fileApiXHR.responseText || (err && fileApiXHR.status === 0 && err !== 'abort' ? err : undefined);\n                            redefineProp(xhr, 'responseText', function () {\n                                return resp;\n                            });\n                            redefineProp(xhr, 'response', function () {\n                                return resp;\n                            });\n                            if (err) redefineProp(xhr, 'err', function () {\n                                return err;\n                            });\n                            xhr.__fileApiXHR = fileApiXHR;\n                            if (xhr.onreadystatechange) xhr.onreadystatechange();\n                            if (xhr.onload) xhr.onload();\n                        },\n                        progress: function (e) {\n                            e.target = xhr;\n                            if (xhr.__listeners.progress) xhr.__listeners.progress(e);\n                            xhr.__total = e.total;\n                            xhr.__loaded = e.loaded;\n                            if (e.total === e.loaded) {\n                                // fix flash issue that doesn't call complete if there is no response text from the server\n                                var _this = this;\n                                setTimeout(function () {\n                                    if (!xhr.__completed) {\n                                        xhr.getAllResponseHeaders = function () {\n                                        };\n                                        _this.complete(null, {status: 204, statusText: 'No Content'});\n                                    }\n                                }, FileAPI.noContentTimeout || 10000);\n                            }\n                        },\n                        headers: xhr.__requestHeaders\n                    };\n                    config.data = {};\n                    config.files = {};\n                    for (var i = 0; i < formData.data.length; i++) {\n                        var item = formData.data[i];\n                        if (item.val != null && item.val.name != null && item.val.size != null && item.val.type != null) {\n                            config.files[item.key] = item.val;\n                        } else {\n                            config.data[item.key] = item.val;\n                        }\n                    }\n\n                    setTimeout(function () {\n                        if (!FileAPI.hasFlash) {\n                            throw 'Adode Flash Player need to be installed. To check ahead use \"FileAPI.hasFlash\"';\n                        }\n                        xhr.__fileApiXHR = FileAPI.upload(config);\n                    }, 1);\n                } else {\n                    if (this.__origError) {\n                        throw this.__origError;\n                    }\n                    orig.apply(xhr, arguments);\n                }\n            };\n        });\n        window.XMLHttpRequest.__isFileAPIShim = true;\n        window.FormData = FormData = function () {\n            return {\n                append: function (key, val, name) {\n                    if (val.__isFileAPIBlobShim) {\n                        val = val.data[0];\n                    }\n                    this.data.push({\n                        key: key,\n                        val: val,\n                        name: name\n                    });\n                },\n                data: [],\n                __isFileAPIShim: true\n            };\n        };\n\n        window.Blob = Blob = function (b) {\n            return {\n                data: b,\n                __isFileAPIBlobShim: true\n            };\n        };\n    }\n\n})();\n\n(function () {\n    /** @module FileAPI.forceLoad */\n    /** @module window.FileAPI.jsUrl */\n    /** @module window.FileAPI.jsPath */\n\n    function isInputTypeFile(elem) {\n        return elem[0].tagName.toLowerCase() === 'input' && elem.attr('type') && elem.attr('type').toLowerCase() === 'file';\n    }\n\n    function hasFlash() {\n        try {\n            var fo = new ActiveXObject('ShockwaveFlash.ShockwaveFlash');\n            if (fo) return true;\n        } catch (e) {\n            if (navigator.mimeTypes['application/x-shockwave-flash'] !== undefined) return true;\n        }\n        return false;\n    }\n\n    function getOffset(obj) {\n        var left = 0, top = 0;\n\n        if (window.jQuery) {\n            return jQuery(obj).offset();\n        }\n\n        if (obj.offsetParent) {\n            do {\n                left += (obj.offsetLeft - obj.scrollLeft);\n                top += (obj.offsetTop - obj.scrollTop);\n                obj = obj.offsetParent;\n            } while (obj);\n        }\n        return {\n            left: left,\n            top: top\n        };\n    }\n\n    if (FileAPI.shouldLoad) {\n\n        //load FileAPI\n        if (FileAPI.forceLoad) {\n            FileAPI.html5 = false;\n        }\n\n        if (!FileAPI.upload) {\n            var jsUrl, basePath, script = document.createElement('script'), allScripts = document.getElementsByTagName('script'), i, index, src;\n            if (window.FileAPI.jsUrl) {\n                jsUrl = window.FileAPI.jsUrl;\n            } else if (window.FileAPI.jsPath) {\n                basePath = window.FileAPI.jsPath;\n            } else {\n                for (i = 0; i < allScripts.length; i++) {\n                    src = allScripts[i].src;\n                    index = src.search(/\\/ng\\-file\\-upload[\\-a-zA-z0-9\\.]*\\.js/);\n                    if (index > -1) {\n                        basePath = src.substring(0, index + 1);\n                        break;\n                    }\n                }\n            }\n\n            if (FileAPI.staticPath == null) FileAPI.staticPath = basePath;\n            script.setAttribute('src', jsUrl || basePath + 'FileAPI.min.js');\n            document.getElementsByTagName('head')[0].appendChild(script);\n\n            FileAPI.hasFlash = hasFlash();\n        }\n\n        FileAPI.ngfFixIE = function (elem, createFileElemFn, bindAttr, changeFn) {\n            if (!hasFlash()) {\n                throw 'Adode Flash Player need to be installed. To check ahead use \"FileAPI.hasFlash\"';\n            }\n            var makeFlashInput = function () {\n                if (elem.attr('disabled')) {\n                    elem.$$ngfRefElem.removeClass('js-fileapi-wrapper');\n                } else {\n                    var fileElem = elem.$$ngfRefElem;\n                    if (!fileElem) {\n                        fileElem = elem.$$ngfRefElem = createFileElemFn();\n                        fileElem.addClass('js-fileapi-wrapper');\n                        if (!isInputTypeFile(elem)) {\n//\t\t\t\t\t\tif (fileElem.parent().css('position') === '' || fileElem.parent().css('position') === 'static') {\n//\t\t\t\t\t\t\tfileElem.parent().css('position', 'relative');\n//\t\t\t\t\t\t}\n//\t\t\t\t\t\telem.parent()[0].insertBefore(fileElem[0], elem[0]);\n//\t\t\t\t\t\telem.css('overflow', 'hidden');\n                        }\n                        setTimeout(function () {\n                            fileElem.bind('mouseenter', makeFlashInput);\n                        }, 10);\n                        fileElem.bind('change', function (evt) {\n                            fileApiChangeFn.apply(this, [evt]);\n                            changeFn.apply(this, [evt]);\n//\t\t\t\t\t\talert('change' +  evt);\n                        });\n                    } else {\n                        bindAttr(elem.$$ngfRefElem);\n                    }\n                    if (!isInputTypeFile(elem)) {\n                        fileElem.css('position', 'absolute')\n                            .css('top', getOffset(elem[0]).top + 'px').css('left', getOffset(elem[0]).left + 'px')\n                            .css('width', elem[0].offsetWidth + 'px').css('height', elem[0].offsetHeight + 'px')\n                            .css('filter', 'alpha(opacity=0)').css('display', elem.css('display'))\n                            .css('overflow', 'hidden').css('z-index', '900000')\n                            .css('visibility', 'visible');\n                    }\n                }\n            };\n\n            elem.bind('mouseenter', makeFlashInput);\n\n            var fileApiChangeFn = function (evt) {\n                var files = FileAPI.getFiles(evt);\n                //just a double check for #233\n                for (var i = 0; i < files.length; i++) {\n                    if (files[i].size === undefined) files[i].size = 0;\n                    if (files[i].name === undefined) files[i].name = 'file';\n                    if (files[i].type === undefined) files[i].type = 'undefined';\n                }\n                if (!evt.target) {\n                    evt.target = {};\n                }\n                evt.target.files = files;\n                // if evt.target.files is not writable use helper field\n                if (evt.target.files !== files) {\n                    evt.__files_ = files;\n                }\n                (evt.__files_ || evt.target.files).item = function (i) {\n                    return (evt.__files_ || evt.target.files)[i] || null;\n                };\n            };\n        };\n\n        FileAPI.disableFileInput = function (elem, disable) {\n            if (disable) {\n                elem.removeClass('js-fileapi-wrapper');\n            } else {\n                elem.addClass('js-fileapi-wrapper');\n            }\n        };\n    }\n})();\n\nif (!window.FileReader) {\n    window.FileReader = function () {\n        var _this = this, loadStarted = false;\n        this.listeners = {};\n        this.addEventListener = function (type, fn) {\n            _this.listeners[type] = _this.listeners[type] || [];\n            _this.listeners[type].push(fn);\n        };\n        this.removeEventListener = function (type, fn) {\n            if (_this.listeners[type]) _this.listeners[type].splice(_this.listeners[type].indexOf(fn), 1);\n        };\n        this.dispatchEvent = function (evt) {\n            var list = _this.listeners[evt.type];\n            if (list) {\n                for (var i = 0; i < list.length; i++) {\n                    list[i].call(_this, evt);\n                }\n            }\n        };\n        this.onabort = this.onerror = this.onload = this.onloadstart = this.onloadend = this.onprogress = null;\n\n        var constructEvent = function (type, evt) {\n            var e = {type: type, target: _this, loaded: evt.loaded, total: evt.total, error: evt.error};\n            if (evt.result != null) e.target.result = evt.result;\n            return e;\n        };\n        var listener = function (evt) {\n            if (!loadStarted) {\n                loadStarted = true;\n                if (_this.onloadstart) _this.onloadstart(constructEvent('loadstart', evt));\n            }\n            var e;\n            if (evt.type === 'load') {\n                if (_this.onloadend) _this.onloadend(constructEvent('loadend', evt));\n                e = constructEvent('load', evt);\n                if (_this.onload) _this.onload(e);\n                _this.dispatchEvent(e);\n            } else if (evt.type === 'progress') {\n                e = constructEvent('progress', evt);\n                if (_this.onprogress) _this.onprogress(e);\n                _this.dispatchEvent(e);\n            } else {\n                e = constructEvent('error', evt);\n                if (_this.onerror) _this.onerror(e);\n                _this.dispatchEvent(e);\n            }\n        };\n        this.readAsArrayBuffer = function (file) {\n            FileAPI.readAsBinaryString(file, listener);\n        };\n        this.readAsBinaryString = function (file) {\n            FileAPI.readAsBinaryString(file, listener);\n        };\n        this.readAsDataURL = function (file) {\n            FileAPI.readAsDataURL(file, listener);\n        };\n        this.readAsText = function (file) {\n            FileAPI.readAsText(file, listener);\n        };\n    };\n}\n\n/**!\n * AngularJS file upload/drop directive and service with progress and abort\n * @author  Danial  <danial.farid@gmail.com>\n * @version 6.0.2\n */\n\nif (window.XMLHttpRequest && !(window.FileAPI && FileAPI.shouldLoad)) {\n    window.XMLHttpRequest.prototype.setRequestHeader = (function (orig) {\n        return function (header, value) {\n            if (header === '__setXHR_') {\n                var val = value(this);\n                // fix for angular < 1.2.0\n                if (val instanceof Function) {\n                    val(this);\n                }\n            } else {\n                orig.apply(this, arguments);\n            }\n        };\n    })(window.XMLHttpRequest.prototype.setRequestHeader);\n}\n\nvar ngFileUpload = angular.module('ngFileUpload', []);\n\nngFileUpload.version = '6.0.2';\nngFileUpload.defaults = {};\n\nngFileUpload.service('Upload', ['$http', '$q', '$timeout', function ($http, $q, $timeout) {\n    function sendHttp(config) {\n        config.method = config.method || 'POST';\n        config.headers = config.headers || {};\n\n        var deferred = $q.defer();\n        var promise = deferred.promise;\n\n        config.headers.__setXHR_ = function () {\n            return function (xhr) {\n                if (!xhr) return;\n                config.__XHR = xhr;\n                if (config.xhrFn) config.xhrFn(xhr);\n                xhr.upload.addEventListener('progress', function (e) {\n                    e.config = config;\n                    if (deferred.notify) {\n                        deferred.notify(e);\n                    } else if (promise.progressFunc) {\n                        $timeout(function () {\n                            promise.progressFunc(e);\n                        });\n                    }\n                }, false);\n                //fix for firefox not firing upload progress end, also IE8-9\n                xhr.upload.addEventListener('load', function (e) {\n                    if (e.lengthComputable) {\n                        e.config = config;\n                        if (deferred.notify) {\n                            deferred.notify(e);\n                        } else if (promise.progressFunc) {\n                            $timeout(function () {\n                                promise.progressFunc(e);\n                            });\n                        }\n                    }\n                }, false);\n            };\n        };\n\n        $http(config).then(function (r) {\n            deferred.resolve(r);\n        }, function (e) {\n            deferred.reject(e);\n        }, function (n) {\n            deferred.notify(n);\n        });\n\n        promise.success = function (fn) {\n            promise.then(function (response) {\n                fn(response.data, response.status, response.headers, config);\n            });\n            return promise;\n        };\n\n        promise.error = function (fn) {\n            promise.then(null, function (response) {\n                fn(response.data, response.status, response.headers, config);\n            });\n            return promise;\n        };\n\n        promise.progress = function (fn) {\n            promise.progressFunc = fn;\n            promise.then(null, null, function (update) {\n                fn(update);\n            });\n            return promise;\n        };\n        promise.abort = function () {\n            if (config.__XHR) {\n                $timeout(function () {\n                    config.__XHR.abort();\n                });\n            }\n            return promise;\n        };\n        promise.xhr = function (fn) {\n            config.xhrFn = (function (origXhrFn) {\n                return function () {\n                    if (origXhrFn) origXhrFn.apply(promise, arguments);\n                    fn.apply(promise, arguments);\n                };\n            })(config.xhrFn);\n            return promise;\n        };\n\n        return promise;\n    }\n\n    this.upload = function (config) {\n        function addFieldToFormData(formData, val, key) {\n            if (val !== undefined) {\n                if (angular.isDate(val)) {\n                    val = val.toISOString();\n                }\n                if (angular.isString(val)) {\n                    formData.append(key, val);\n                } else if (config.sendFieldsAs === 'form') {\n                    if (angular.isObject(val)) {\n                        for (var k in val) {\n                            if (val.hasOwnProperty(k)) {\n                                addFieldToFormData(formData, val[k], key + '[' + k + ']');\n                            }\n                        }\n                    } else {\n                        formData.append(key, val);\n                    }\n                } else {\n                    val = angular.isString(val) ? val : JSON.stringify(val);\n                    if (config.sendFieldsAs === 'json-blob') {\n                        formData.append(key, new Blob([val], {type: 'application/json'}));\n                    } else {\n                        formData.append(key, val);\n                    }\n                }\n            }\n        }\n\n        config.headers = config.headers || {};\n        config.headers['Content-Type'] = undefined;\n        config.transformRequest = config.transformRequest ?\n            (angular.isArray(config.transformRequest) ?\n                config.transformRequest : [config.transformRequest]) : [];\n        config.transformRequest.push(function (data) {\n            var formData = new FormData();\n            var allFields = {};\n            var key;\n            for (key in config.fields) {\n                if (config.fields.hasOwnProperty(key)) {\n                    allFields[key] = config.fields[key];\n                }\n            }\n            if (data) allFields.data = data;\n            for (key in allFields) {\n                if (allFields.hasOwnProperty(key)) {\n                    var val = allFields[key];\n                    if (config.formDataAppender) {\n                        config.formDataAppender(formData, key, val);\n                    } else {\n                        addFieldToFormData(formData, val, key);\n                    }\n                }\n            }\n\n            if (config.file != null) {\n                var fileFormName = config.fileFormDataName || 'file';\n\n                if (angular.isArray(config.file)) {\n                    var isFileFormNameString = angular.isString(fileFormName);\n                    for (var i = 0; i < config.file.length; i++) {\n                        formData.append(isFileFormNameString ? fileFormName : fileFormName[i], config.file[i],\n                            (config.fileName && config.fileName[i]) || config.file[i].name);\n                    }\n                } else {\n                    formData.append(fileFormName, config.file, config.fileName || config.file.name);\n                }\n            }\n            return formData;\n        });\n\n        return sendHttp(config);\n    };\n\n    this.http = function (config) {\n        config.transformRequest = config.transformRequest || function (data) {\n                if ((window.ArrayBuffer && data instanceof window.ArrayBuffer) || data instanceof Blob) {\n                    return data;\n                }\n                return $http.defaults.transformRequest[0](arguments);\n            };\n        return sendHttp(config);\n    };\n\n    this.dataUrl = function (file, callback, disallowObjectUrl) {\n        if (window.FileReader && file &&\n            (!window.FileAPI || navigator.userAgent.indexOf('MSIE 8') === -1 || file.size < 20000) &&\n            (!window.FileAPI || navigator.userAgent.indexOf('MSIE 9') === -1 || file.size < 4000000)) {\n            $timeout(function () {\n                //prefer URL.createObjectURL for handling refrences to files of all sizes\n                //since it doesn´t build a large string in memory\n                var URL = window.URL || window.webkitURL;\n                if (URL && URL.createObjectURL && !disallowObjectUrl) {\n                    callback(URL.createObjectURL(file));\n                } else {\n                    var fileReader = new FileReader();\n                    fileReader.readAsDataURL(file);\n                    fileReader.onload = function (e) {\n                        $timeout(function () {\n                            callback(e.target.result);\n                        });\n                    };\n                }\n            });\n        } else {\n            callback(null);\n        }\n    };\n\n    this.setDefaults = function(defaults) {\n        ngFileUpload.defaults = defaults || {};\n    };\n}\n\n]);\n\n(function () {\n    ngFileUpload.getAttrWithDefaults = function(attr, name) {\n        return attr[name] != null ? attr[name] :\n            (ngFileUpload.defaults[name] == null ?\n                ngFileUpload.defaults[name] : ngFileUpload.defaults[name].toString());\n    };\n\n    var getAttr = ngFileUpload.getAttrWithDefaults;\n\n    ngFileUpload.directive('ngfSelect', ['$parse', '$timeout', '$compile',\n        function ($parse, $timeout, $compile) {\n            return {\n                restrict: 'AEC',\n                require: '?ngModel',\n                link: function (scope, elem, attr, ngModel) {\n                    linkFileSelect(scope, elem, attr, ngModel, $parse, $timeout, $compile);\n                }\n            };\n        }]);\n\n    function linkFileSelect(scope, elem, attr, ngModel, $parse, $timeout, $compile) {\n        /** @module attr.ngfSelect */\n        /** @module attr.ngfChange */\n        /** @module attr.ngModel */\n        /** @module attr.ngModelRejected */\n        /** @module attr.ngfModel */\n        /** @module attr.ngfMultiple */\n        /** @module attr.ngfCapture */\n        /** @module attr.ngfAccept */\n        /** @module attr.ngfMaxSize */\n        /** @module attr.ngfMinSize */\n        /** @module attr.ngfResetOnClick */\n        /** @module attr.ngfResetModelOnClick */\n        /** @module attr.ngfKeep */\n        /** @module attr.ngfKeepDistinct */\n\n        if (elem.attr('__ngf_gen__')) {\n            return;\n        }\n\n        scope.$on('$destroy', function () {\n            if (elem.$$ngfRefElem) elem.$$ngfRefElem.remove();\n        });\n\n        var disabled = false;\n        if (getAttr(attr, 'ngfSelect').search(/\\W+$files\\W+/) === -1) {\n            scope.$watch(getAttr(attr, 'ngfSelect'), function (val) {\n                disabled = val === false;\n            });\n        }\n        function isInputTypeFile() {\n            return elem[0].tagName.toLowerCase() === 'input' && attr.type && attr.type.toLowerCase() === 'file';\n        }\n\n        var isUpdating = false;\n\n        function changeFn(evt) {\n            if (!isUpdating) {\n                isUpdating = true;\n                try {\n                    var fileList = evt.__files_ || (evt.target && evt.target.files);\n                    var files = [], rejFiles = [];\n\n                    for (var i = 0; i < fileList.length; i++) {\n                        var file = fileList.item(i);\n                        if (validate(scope, $parse, attr, file, evt)) {\n                            files.push(file);\n                        } else {\n                            rejFiles.push(file);\n                        }\n                    }\n                    updateModel($parse, $timeout, scope, ngModel, attr,\n                        getAttr(attr, 'ngfChange') || getAttr(attr, 'ngfSelect'), files, rejFiles, evt);\n                    if (files.length === 0) evt.target.value = files;\n//                if (evt.target && evt.target.getAttribute('__ngf_gen__')) {\n//                    angular.element(evt.target).remove();\n//                }\n                } finally {\n                    isUpdating = false;\n                }\n            }\n        }\n\n        function bindAttrToFileInput(fileElem) {\n            if (getAttr(attr, 'ngfMultiple')) fileElem.attr('multiple', $parse(getAttr(attr, 'ngfMultiple'))(scope));\n            if (getAttr(attr, 'ngfCapture')) fileElem.attr('capture', $parse(getAttr(attr, 'ngfCapture'))(scope));\n            if (getAttr(attr, 'accept')) fileElem.attr('accept', getAttr(attr, 'accept'));\n            for (var i = 0; i < elem[0].attributes.length; i++) {\n                var attribute = elem[0].attributes[i];\n                if ((isInputTypeFile() && attribute.name !== 'type') ||\n                    (attribute.name !== 'type' && attribute.name !== 'class' &&\n                    attribute.name !== 'id' && attribute.name !== 'style')) {\n                    if (attribute.value == null || attribute.value === '') {\n                        if (attribute.name === 'required') attribute.value = 'required';\n                        if (attribute.name === 'multiple') attribute.value = 'multiple';\n                    }\n                    fileElem.attr(attribute.name, attribute.value);\n                }\n            }\n        }\n\n        function createFileInput(evt, resetOnClick) {\n            if (!resetOnClick && (evt || isInputTypeFile())) return elem.$$ngfRefElem || elem;\n\n            var fileElem = angular.element('<input type=\"file\">');\n            bindAttrToFileInput(fileElem);\n\n            if (isInputTypeFile()) {\n                elem.replaceWith(fileElem);\n                elem = fileElem;\n                fileElem.attr('__ngf_gen__', true);\n                $compile(elem)(scope);\n            } else {\n                fileElem.css('visibility', 'hidden').css('position', 'absolute').css('overflow', 'hidden')\n                    .css('width', '0px').css('height', '0px').css('z-index', '-100000').css('border', 'none')\n                    .css('margin', '0px').css('padding', '0px').attr('tabindex', '-1');\n                if (elem.$$ngfRefElem) {\n                    elem.$$ngfRefElem.remove();\n                }\n                elem.$$ngfRefElem = fileElem;\n                document.body.appendChild(fileElem[0]);\n            }\n\n            return fileElem;\n        }\n\n        function resetModel(evt) {\n            updateModel($parse, $timeout, scope, ngModel, attr,\n                getAttr(attr, 'ngfChange') || getAttr(attr, 'ngfSelect'), [], [], evt, true);\n        }\n\n        var initialTouchStartY = 0;\n\n        function clickHandler(evt) {\n            if (elem.attr('disabled') || disabled) return false;\n\n            if (evt != null) {\n                if (evt.type === 'touchstart') {\n                    initialTouchStartY = evt.originalEvent.touches[0].clientY;\n                    return true; // don't block event default\n                } else {\n                    evt.stopPropagation();\n                    evt.preventDefault();\n\n                    // prevent scroll from triggering event\n                    if (evt.type === 'touchend') {\n                        var currentLocation = evt.originalEvent.changedTouches[0].clientY;\n                        if (Math.abs(currentLocation - initialTouchStartY) > 20) return false;\n                    }\n                }\n            }\n\n            var resetOnClick = $parse(getAttr(attr, 'ngfResetOnClick'))(scope) !== false;\n            var fileElem = createFileInput(evt, resetOnClick);\n\n            function clickAndAssign(evt) {\n                if (evt && evt.clientY > 0) {\n                    fileElem[0].click();\n                }\n                if ((isInputTypeFile() || !evt) && resetOnClick) {\n                    elem.bind('click touchend touchstart', clickHandler);\n                }\n            }\n\n            if (fileElem) {\n                if (!evt || resetOnClick) fileElem.bind('change', changeFn);\n                if (evt && resetOnClick && $parse(getAttr(attr, 'ngfResetModelOnClick'))(scope) !== false) {\n                    resetModel(evt);\n                }\n\n                // fix for android native browser < 4.4\n                if (shouldClickLater(navigator.userAgent)) {\n                    setTimeout(function () {\n                        clickAndAssign(evt);\n                    }, 0);\n                } else {\n                    clickAndAssign(evt);\n                }\n            }\n\n            return false;\n        }\n\n        if (window.FileAPI && window.FileAPI.ngfFixIE) {\n            window.FileAPI.ngfFixIE(elem, createFileInput, bindAttrToFileInput, changeFn);\n        } else {\n            clickHandler();\n            //if (!isInputTypeFile()) {\n            //  elem.bind('click touchend', clickHandler);\n            //}\n        }\n    }\n\n    function shouldClickLater(ua) {\n        // android below 4.4\n        var m = ua.match(/Android[^\\d]*(\\d+)\\.(\\d+)/);\n        if (m && m.length > 2) {\n            var v = ngFileUpload.defaults.androidFixMinorVersion || 4;\n            return parseInt(m[1]) < 4 || (parseInt(m[1]) === v && parseInt(m[2]) < v);\n        }\n\n        // safari on windows\n        return ua.indexOf('Chrome') === -1 && /.*Windows.*Safari.*/.test(ua);\n    }\n\n    ngFileUpload.validate = function (scope, $parse, attr, file, evt) {\n        if (file == null) {\n            return false;\n        }\n        function globStringToRegex(str) {\n            if (str.length > 2 && str[0] === '/' && str[str.length - 1] === '/') {\n                return str.substring(1, str.length - 1);\n            }\n            var split = str.split(','), result = '';\n            if (split.length > 1) {\n                for (var i = 0; i < split.length; i++) {\n                    result += '(' + globStringToRegex(split[i]) + ')';\n                    if (i < split.length - 1) {\n                        result += '|';\n                    }\n                }\n            } else {\n                if (str.indexOf('.') === 0) {\n                    str = '*' + str;\n                }\n                result = '^' + str.replace(new RegExp('[.\\\\\\\\+*?\\\\[\\\\^\\\\]$(){}=!<>|:\\\\' + '-]', 'g'), '\\\\$&') + '$';\n                result = result.replace(/\\\\\\*/g, '.*').replace(/\\\\\\?/g, '.');\n            }\n            return result;\n        }\n\n        var accept = $parse(getAttr(attr, 'ngfAccept'))(scope, {$file: file, $event: evt});\n        var fileSizeMax = $parse(getAttr(attr, 'ngfMaxSize'))(scope, {$file: file, $event: evt}) || 9007199254740991;\n        var fileSizeMin = $parse(getAttr(attr, 'ngfMinSize'))(scope, {$file: file, $event: evt}) || -1;\n        if (accept != null && angular.isString(accept)) {\n            var regexp = new RegExp(globStringToRegex(accept), 'gi');\n            accept = (file.type != null && regexp.test(file.type.toLowerCase())) ||\n                (file.name != null && regexp.test(file.name.toLowerCase()));\n            if (!accept) {\n                file.$error = 'accept';\n                return false;\n            }\n        } else {\n            if (accept === false) {\n                file.$error = 'accept';\n                return false;\n            }\n        }\n        if (file.size == null) return true;\n        if (file.size > fileSizeMax) {\n            file.$error = 'maxSize';\n            return false;\n        }\n        if (file.size < fileSizeMin) {\n            file.$error = 'minSize';\n            return false;\n        }\n        return true;\n    };\n\n    ngFileUpload.updateModel = function ($parse, $timeout, scope, ngModel, attr, fileChange,\n                                         files, rejFiles, evt, noDelay) {\n        function update() {\n            var keep = $parse(getAttr(attr, 'ngfKeep'))(scope);\n            if (keep === true) {\n                var prevFiles = (ngModel.$modelValue || []).slice(0);\n                if (!files || !files.length) {\n                    files = prevFiles;\n                } else if ($parse(getAttr(attr, 'ngfKeepDistinct'))(scope) === true) {\n                    var len = prevFiles.length;\n                    for (var i = 0; i < files.length; i++) {\n                        for (var j = 0; j < len; j++) {\n                            if (files[i].name === prevFiles[j].name) break;\n                        }\n                        if (j === len) {\n                            prevFiles.push(files[i]);\n                        }\n                    }\n                    files = prevFiles;\n                } else {\n                    files = prevFiles.concat(files);\n                }\n            }\n            var file = files && files.length ? files[0] : null;\n            if (ngModel) {\n                var singleModel = !$parse(getAttr(attr, 'ngfMultiple'))(scope) && ! getAttr(attr, 'multiple') && !keep;\n                $parse(getAttr(attr, 'ngModel')).assign(scope, singleModel ? file : files);\n                $timeout(function () {\n                    if (ngModel) {\n                        ngModel.$setViewValue(singleModel ? file : (files != null && files.length === 0 ? null : files));\n                    }\n                });\n            }\n            var ngfModel = getAttr(attr, 'ngfModel');\n            if (ngfModel) {\n                $parse(ngfModel).assign(scope, files);\n            }\n\n            if (getAttr(attr, 'ngModelRejected')) {\n                $parse(getAttr(attr, 'ngModelRejected')).assign(scope, rejFiles);\n            }\n            if (fileChange) {\n                $parse(fileChange)(scope, {\n                    $files: files,\n                    $file: file,\n                    $rejectedFiles: rejFiles,\n                    $event: evt\n                });\n            }\n        }\n\n        if (noDelay) {\n            update();\n        } else {\n            $timeout(function () {\n                update();\n            });\n        }\n    };\n\n    var validate = ngFileUpload.validate;\n    var updateModel = ngFileUpload.updateModel;\n\n})();\n\n(function () {\n    var validate = ngFileUpload.validate;\n    var updateModel = ngFileUpload.updateModel;\n    var getAttr = ngFileUpload.getAttrWithDefaults;\n\n    ngFileUpload.directive('ngfDrop', ['$parse', '$timeout', '$location', function ($parse, $timeout, $location) {\n        return {\n            restrict: 'AEC',\n            require: '?ngModel',\n            link: function (scope, elem, attr, ngModel) {\n                linkDrop(scope, elem, attr, ngModel, $parse, $timeout, $location);\n            }\n        };\n    }]);\n\n    ngFileUpload.directive('ngfNoFileDrop', function () {\n        return function (scope, elem) {\n            if (dropAvailable()) elem.css('display', 'none');\n        };\n    });\n\n    ngFileUpload.directive('ngfDropAvailable', ['$parse', '$timeout', function ($parse, $timeout) {\n        return function (scope, elem, attr) {\n            if (dropAvailable()) {\n                var fn = $parse(getAttr(attr, 'ngfDropAvailable'));\n                $timeout(function () {\n                    fn(scope);\n                    if (fn.assign) {\n                        fn.assign(scope, true);\n                    }\n                });\n            }\n        };\n    }]);\n\n    function linkDrop(scope, elem, attr, ngModel, $parse, $timeout, $location) {\n        var available = dropAvailable();\n        if (getAttr(attr, 'dropAvailable')) {\n            $timeout(function () {\n                if (scope[getAttr(attr, 'dropAvailable')]) {\n                    scope[getAttr(attr, 'dropAvailable')].value = available;\n                } else {\n                    scope[getAttr(attr, 'dropAvailable')] = available;\n                }\n            });\n        }\n        if (!available) {\n            if ($parse(getAttr(attr, 'ngfHideOnDropNotAvailable'))(scope) === true) {\n                elem.css('display', 'none');\n            }\n            return;\n        }\n\n        var disabled = false;\n        if (getAttr(attr, 'ngfDrop').search(/\\W+$files\\W+/) === -1) {\n            scope.$watch(getAttr(attr, 'ngfDrop'), function(val) {\n                disabled = val === false;\n            });\n        }\n\n        var leaveTimeout = null;\n        var stopPropagation = $parse(getAttr(attr, 'ngfStopPropagation'));\n        var dragOverDelay = 1;\n        var actualDragOverClass;\n\n        elem[0].addEventListener('dragover', function (evt) {\n            if (elem.attr('disabled') || disabled) return;\n            evt.preventDefault();\n            if (stopPropagation(scope)) evt.stopPropagation();\n            // handling dragover events from the Chrome download bar\n            if (navigator.userAgent.indexOf('Chrome') > -1) {\n                var b = evt.dataTransfer.effectAllowed;\n                evt.dataTransfer.dropEffect = ('move' === b || 'linkMove' === b) ? 'move' : 'copy';\n            }\n            $timeout.cancel(leaveTimeout);\n            if (!scope.actualDragOverClass) {\n                actualDragOverClass = calculateDragOverClass(scope, attr, evt);\n            }\n            elem.addClass(actualDragOverClass);\n        }, false);\n        elem[0].addEventListener('dragenter', function (evt) {\n            if (elem.attr('disabled') || disabled) return;\n            evt.preventDefault();\n            if (stopPropagation(scope)) evt.stopPropagation();\n        }, false);\n        elem[0].addEventListener('dragleave', function () {\n            if (elem.attr('disabled') || disabled) return;\n            leaveTimeout = $timeout(function () {\n                elem.removeClass(actualDragOverClass);\n                actualDragOverClass = null;\n            }, dragOverDelay || 1);\n        }, false);\n        elem[0].addEventListener('drop', function (evt) {\n            if (elem.attr('disabled') || disabled) return;\n            evt.preventDefault();\n            if (stopPropagation(scope)) evt.stopPropagation();\n            elem.removeClass(actualDragOverClass);\n            actualDragOverClass = null;\n            extractFiles(evt, function (files, rejFiles) {\n                    updateModel($parse, $timeout, scope, ngModel, attr,\n                        getAttr(attr, 'ngfChange') || getAttr(attr, 'ngfDrop'), files, rejFiles, evt);\n                }, $parse(getAttr(attr, 'ngfAllowDir'))(scope) !== false,\n                getAttr(attr, 'multiple') || $parse(getAttr(attr, 'ngfMultiple'))(scope));\n        }, false);\n\n        function calculateDragOverClass(scope, attr, evt) {\n            var accepted = true;\n            var items = evt.dataTransfer.items;\n            if (items != null) {\n                for (var i = 0; i < items.length && accepted; i++) {\n                    accepted = accepted &&\n                        (items[i].kind === 'file' || items[i].kind === '') &&\n                        validate(scope, $parse, attr, items[i], evt);\n                }\n            }\n            var clazz = $parse(getAttr(attr, 'ngfDragOverClass'))(scope, {$event: evt});\n            if (clazz) {\n                if (clazz.delay) dragOverDelay = clazz.delay;\n                if (clazz.accept) clazz = accepted ? clazz.accept : clazz.reject;\n            }\n            return clazz || getAttr(attr, 'ngfDragOverClass') || 'dragover';\n        }\n\n        function extractFiles(evt, callback, allowDir, multiple) {\n            var files = [], rejFiles = [], items = evt.dataTransfer.items, processing = 0;\n\n            function addFile(file) {\n                if (validate(scope, $parse, attr, file, evt)) {\n                    files.push(file);\n                } else {\n                    rejFiles.push(file);\n                }\n            }\n\n            function traverseFileTree(files, entry, path) {\n                if (entry != null) {\n                    if (entry.isDirectory) {\n                        var filePath = (path || '') + entry.name;\n                        addFile({name: entry.name, type: 'directory', path: filePath});\n                        var dirReader = entry.createReader();\n                        var entries = [];\n                        processing++;\n                        var readEntries = function () {\n                            dirReader.readEntries(function (results) {\n                                try {\n                                    if (!results.length) {\n                                        for (var i = 0; i < entries.length; i++) {\n                                            traverseFileTree(files, entries[i], (path ? path : '') + entry.name + '/');\n                                        }\n                                        processing--;\n                                    } else {\n                                        entries = entries.concat(Array.prototype.slice.call(results || [], 0));\n                                        readEntries();\n                                    }\n                                } catch (e) {\n                                    processing--;\n                                    console.error(e);\n                                }\n                            }, function () {\n                                processing--;\n                            });\n                        };\n                        readEntries();\n                    } else {\n                        processing++;\n                        entry.file(function (file) {\n                            try {\n                                processing--;\n                                file.path = (path ? path : '') + file.name;\n                                addFile(file);\n                            } catch (e) {\n                                processing--;\n                                console.error(e);\n                            }\n                        }, function () {\n                            processing--;\n                        });\n                    }\n                }\n            }\n\n            if (items && items.length > 0 && $location.protocol() !== 'file') {\n                for (var i = 0; i < items.length; i++) {\n                    if (items[i].webkitGetAsEntry && items[i].webkitGetAsEntry() && items[i].webkitGetAsEntry().isDirectory) {\n                        var entry = items[i].webkitGetAsEntry();\n                        if (entry.isDirectory && !allowDir) {\n                            continue;\n                        }\n                        if (entry != null) {\n                            traverseFileTree(files, entry);\n                        }\n                    } else {\n                        var f = items[i].getAsFile();\n                        if (f != null) addFile(f);\n                    }\n                    if (!multiple && files.length > 0) break;\n                }\n            } else {\n                var fileList = evt.dataTransfer.files;\n                if (fileList != null) {\n                    for (var j = 0; j < fileList.length; j++) {\n                        addFile(fileList.item(j));\n                        if (!multiple && files.length > 0) {\n                            break;\n                        }\n                    }\n                }\n            }\n            var delays = 0;\n            (function waitForProcess(delay) {\n                $timeout(function () {\n                    if (!processing) {\n                        if (!multiple && files.length > 1) {\n                            i = 0;\n                            while (files[i].type === 'directory') i++;\n                            files = [files[i]];\n                        }\n                        callback(files, rejFiles);\n                    } else {\n                        if (delays++ * 10 < 20 * 1000) {\n                            waitForProcess(10);\n                        }\n                    }\n                }, delay || 0);\n            })();\n        }\n    }\n\n    function dropAvailable() {\n        var div = document.createElement('div');\n        return ('draggable' in div) && ('ondrop' in div);\n    }\n\n})();\n\n(function () {\n\n    function fileToSrc(Upload, scope, $parse, attr, name, defaultName, callback) {\n        scope.$watch(name, function (file) {\n            if (!angular.isString(file)) {\n                if (window.FileReader && ngFileUpload.validate(scope, $parse, attr, file, null)) {\n                    Upload.dataUrl(file, function (url) {\n                        if (callback) {\n                            callback(url);\n                        } else {\n                            file.dataUrl = url || $parse(defaultName)(scope);\n                        }\n                    }, $parse(attr.ngfNoObjectUrl)(scope));\n                }\n            } else {\n                callback(file);\n            }\n        });\n    }\n\n    /** @module attr.ngfSrc */\n    /** @module attr.ngfDefaultSrc */\n    /** @module attr.ngfNoObjectUrl */\n    ngFileUpload.directive('ngfSrc', ['$parse', 'Upload', function ($parse, Upload) {\n        return {\n            restrict: 'AE',\n            link: function (scope, elem, attr) {\n                fileToSrc(Upload, scope, $parse, attr, attr.ngfSrc, attr.ngfDefaultSrc, function (url) {\n                    elem.attr('src', url);\n                });\n            }\n        };\n    }]);\n\n    /** @module attr.ngfBackground */\n    /** @module attr.ngfDefaultBackground */\n    /** @module attr.ngfNoObjectUrl */\n    ngFileUpload.directive('ngfBackground', ['$parse', 'Upload', function ($parse, Upload) {\n        return {\n            restrict: 'AE',\n            link: function (scope, elem, attr) {\n                fileToSrc(Upload, scope, $parse, attr, attr.ngfBackground, attr.ngfDefaultBackground, function (url) {\n                    elem.css('background-image', 'url(' + url + ')');\n                });\n            }\n        };\n    }]);\n\n    /** @module attr.ngfDataUrl */\n    /** @module attr.ngfDefaultDataUrl */\n    /** @module attr.ngfNoObjectUrl */\n    ngFileUpload.directive('ngfDataUrl', ['$parse', 'Upload', function ($parse, Upload) {\n        return {\n            restrict: 'AE',\n            link: function (scope, elem, attr) {\n\n                fileToSrc(Upload, scope, $parse, attr, attr.ngfDataUrl, attr.ngfDefaultDataUrl);\n            }\n        };\n    }]);\n})();"],"sourceRoot":"/source/"}