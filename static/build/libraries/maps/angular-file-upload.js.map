{"version":3,"sources":["angular-file-upload.js"],"names":["patchXHR","fnName","newFn","window","XMLHttpRequest","prototype","linkFileSelect","scope","elem","attr","ngModel","$parse","$timeout","$compile","isInputTypeFile","tagName","toLowerCase","changeFn","evt","isUpdating","fileList","__files_","target","files","rejFiles","i","length","file","item","validate","push","updateModel","ngfChange","ngfSelect","value","bindAttrToFileInput","fileElem","ngfMultiple","undefined","ngfCapture","attributes","attribute","name","createFileInput","angular","element","replaceWith","css","__ngf_ref_elem__","remove","document","body","appendChild","resetModel","clickHandler","clickAndAssign","click","bind","preventDefault","stopPropagation","navigator","userAgent","match","setTimeout","FileAPI","ngfFixIE","linkDrop","$location","calculateDragOverClass","accepted","items","dataTransfer","kind","clazz","ngfDragOverClass","$event","delay","dragOverDelay","accept","reject","extractFiles","callback","allowDir","multiple","addFile","traverseFileTree","entry","path","isDirectory","filePath","type","dirReader","createReader","entries","processing","readEntries","results","concat","Array","slice","call","e","console","error","protocol","webkitGetAsEntry","f","getAsFile","delays","waitForProcess","available","dropAvailable","ngfHideOnDropNotAvailable","actualDragOverClass","leaveTimeout","ngfStopPropagation","ngfAccept","addEventListener","indexOf","b","effectAllowed","dropEffect","cancel","addClass","removeClass","ngfDrop","ngfAllowDir","div","createElement","fileChange","noDelay","update","assign","$setViewValue","ngModelRejected","$files","$rejectedFiles","$file","fileSizeMax","ngfMaxSize","fileSizeMin","ngfMinSize","isString","regexp","RegExp","globStringToRegex","test","size","str","substring","split","result","replace","key","__isFileAPIShim","orig","header","val","this","Function","apply","arguments","ngFileUpload","module","version","service","$http","$q","sendHttp","config","method","headers","transformRequest","data","headersGetter","ArrayBuffer","defaults","deferred","defer","promise","xhr","__XHR","xhrFn","upload","notify","progress_fn","lengthComputable","then","r","resolve","n","success","fn","response","status","progress","abort","origXhrFn","isArray","formData","FormData","allFields","fields","hasOwnProperty","formDataAppender","isDate","toISOString","append","sendObjectsAsJsonBlob","isObject","Blob","JSON","stringify","fileFormName","fileFormDataName","isFileFormNameString","fileName","http","directive","restrict","require","link","ngfDropAvailable","FileReader","$watch","ngfSrc","URL","webkitURL","createObjectURL","fileReader","readAsDataURL","onload","ngfDefaultSrc","redefineProp","prop","Object","defineProperty","get","hasFlash","fo","ActiveXObject","mimeTypes","forceLoad","initializeUploadListener","__listeners","origAddEventListener","t","m","url","__url","message","__origError","h","__fileApiXHR","getResponseHeader","getAllResponseHeaders","__requestHeaders","jsonp","cache","complete","err","fileApiXHR","__completed","loaded","__loaded","total","__total","statusText","resp","responseText","onreadystatechange","_this","noContentTimeout","__isFileAPIBlobShim","html5","jsUrl","basePath","index","src","script","allScripts","getElementsByTagName","jsPath","search","staticPath","setAttribute","createFileElemFn","bindAttr","makeFlashInput","getOffset","obj","left","top","offsetParent","offsetLeft","offsetTop","__ngf_elem__","fileApiChangeFn","offsetWidth","offsetHeight","getFiles","disableFileInput","disable","loadStarted","listeners","removeEventListener","splice","dispatchEvent","list","onabort","onerror","onloadstart","onloadend","onprogress","constructEvent","listener","readAsArrayBuffer","readAsBinaryString","readAsText"],"mappings":"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","file":"angular-file-upload.js","sourcesContent":["/**!\n * AngularJS file upload/drop directive and service with progress and abort\n * @author  Danial  <danial.farid@gmail.com>\n * @version 4.2.4\n */\n(function () {\n\n    var key, i;\n    function patchXHR(fnName, newFn) {\n        window.XMLHttpRequest.prototype[fnName] = newFn(window.XMLHttpRequest.prototype[fnName]);\n    }\n\n    if (window.XMLHttpRequest && !window.XMLHttpRequest.__isFileAPIShim) {\n        patchXHR('setRequestHeader', function (orig) {\n            return function (header, value) {\n                if (header === '__setXHR_') {\n                    var val = value(this);\n                    // fix for angular < 1.2.0\n                    if (val instanceof Function) {\n                        val(this);\n                    }\n                } else {\n                    orig.apply(this, arguments);\n                }\n            }\n        });\n    }\n\n    var ngFileUpload = angular.module('ngFileUpload', []);\n\n    ngFileUpload.version = '4.2.4';\n    ngFileUpload.service('Upload', ['$http', '$q', '$timeout', function ($http, $q, $timeout) {\n        function sendHttp(config) {\n            config.method = config.method || 'POST';\n            config.headers = config.headers || {};\n            config.transformRequest = config.transformRequest || function (data, headersGetter) {\n                    if (window.ArrayBuffer && data instanceof window.ArrayBuffer) {\n                        return data;\n                    }\n                    return $http.defaults.transformRequest[0](data, headersGetter);\n                };\n            var deferred = $q.defer();\n            var promise = deferred.promise;\n\n            config.headers['__setXHR_'] = function () {\n                return function (xhr) {\n                    if (!xhr) return;\n                    config.__XHR = xhr;\n                    config.xhrFn && config.xhrFn(xhr);\n                    xhr.upload.addEventListener('progress', function (e) {\n                        e.config = config;\n                        deferred.notify ? deferred.notify(e) : promise.progress_fn && $timeout(function () {\n                            promise.progress_fn(e)\n                        });\n                    }, false);\n                    //fix for firefox not firing upload progress end, also IE8-9\n                    xhr.upload.addEventListener('load', function (e) {\n                        if (e.lengthComputable) {\n                            e.config = config;\n                            deferred.notify ? deferred.notify(e) : promise.progress_fn && $timeout(function () {\n                                promise.progress_fn(e)\n                            });\n                        }\n                    }, false);\n                };\n            };\n\n            $http(config).then(function (r) {\n                deferred.resolve(r)\n            }, function (e) {\n                deferred.reject(e)\n            }, function (n) {\n                deferred.notify(n)\n            });\n\n            promise.success = function (fn) {\n                promise.then(function (response) {\n                    fn(response.data, response.status, response.headers, config);\n                });\n                return promise;\n            };\n\n            promise.error = function (fn) {\n                promise.then(null, function (response) {\n                    fn(response.data, response.status, response.headers, config);\n                });\n                return promise;\n            };\n\n            promise.progress = function (fn) {\n                promise.progress_fn = fn;\n                promise.then(null, null, function (update) {\n                    fn(update);\n                });\n                return promise;\n            };\n            promise.abort = function () {\n                if (config.__XHR) {\n                    $timeout(function () {\n                        config.__XHR.abort();\n                    });\n                }\n                return promise;\n            };\n            promise.xhr = function (fn) {\n                config.xhrFn = (function (origXhrFn) {\n                    return function () {\n                        origXhrFn && origXhrFn.apply(promise, arguments);\n                        fn.apply(promise, arguments);\n                    }\n                })(config.xhrFn);\n                return promise;\n            };\n\n            return promise;\n        }\n\n        this.upload = function (config) {\n            config.headers = config.headers || {};\n            config.headers['Content-Type'] = undefined;\n            config.transformRequest = config.transformRequest ?\n                (angular.isArray(config.transformRequest) ?\n                    config.transformRequest : [config.transformRequest]) : [];\n            config.transformRequest.push(function (data) {\n                var formData = new FormData();\n                var allFields = {};\n                for (key in config.fields) {\n                    if (config.fields.hasOwnProperty(key)) {\n                        allFields[key] = config.fields[key];\n                    }\n                }\n                if (data) allFields['data'] = data;\n\n                if (config.formDataAppender) {\n                    for (key in allFields) {\n                        if (allFields.hasOwnProperty(key)) {\n                            config.formDataAppender(formData, key, allFields[key]);\n                        }\n                    }\n                } else {\n                    for (key in allFields) {\n                        if (allFields.hasOwnProperty(key)) {\n                            var val = allFields[key];\n                            if (val !== undefined) {\n                                if (angular.isDate(val)) {\n                                    val = val.toISOString();\n                                }\n                                if (angular.isString(val)) {\n                                    formData.append(key, val);\n                                } else {\n                                    if (config.sendObjectsAsJsonBlob && angular.isObject(val)) {\n                                        formData.append(key, new Blob([val], {type: 'application/json'}));\n                                    } else {\n                                        formData.append(key, JSON.stringify(val));\n                                    }\n                                }\n\n                            }\n                        }\n                    }\n                }\n\n                if (config.file != null) {\n                    var fileFormName = config.fileFormDataName || 'file';\n\n                    if (angular.isArray(config.file)) {\n                        var isFileFormNameString = angular.isString(fileFormName);\n                        for (var i = 0; i < config.file.length; i++) {\n                            formData.append(isFileFormNameString ? fileFormName : fileFormName[i], config.file[i],\n                                (config.fileName && config.fileName[i]) || config.file[i].name);\n                        }\n                    } else {\n                        formData.append(fileFormName, config.file, config.fileName || config.file.name);\n                    }\n                }\n                return formData;\n            });\n\n            return sendHttp(config);\n        };\n\n        this.http = function (config) {\n            return sendHttp(config);\n        };\n    }]);\n\n    ngFileUpload.directive('ngfSelect', ['$parse', '$timeout', '$compile',\n        function ($parse, $timeout, $compile) {\n            return {\n                restrict: 'AEC',\n                require: '?ngModel',\n                link: function (scope, elem, attr, ngModel) {\n                    linkFileSelect(scope, elem, attr, ngModel, $parse, $timeout, $compile);\n                }\n            }\n        }]);\n\n    function linkFileSelect(scope, elem, attr, ngModel, $parse, $timeout, $compile) {\n        if (elem.attr('__ngf_gen__')) {\n            return;\n        }\n        function isInputTypeFile() {\n            return elem[0].tagName.toLowerCase() === 'input' && elem.attr('type') && elem.attr('type').toLowerCase() === 'file';\n        }\n        var isUpdating = false;\n        function changeFn(evt) {\n            if (!isUpdating) {\n                isUpdating = true;\n                try {\n                    var fileList = evt.__files_ || (evt.target && evt.target.files);\n                    var files = [], rejFiles = [];\n\n                    for (var i = 0; i < fileList.length; i++) {\n                        var file = fileList.item(i);\n                        if (validate(scope, $parse, attr, file, evt)) {\n                            files.push(file);\n                        } else {\n                            rejFiles.push(file);\n                        }\n                    }\n                    updateModel($parse, $timeout, scope, ngModel, attr, attr.ngfChange || attr.ngfSelect, files, rejFiles, evt);\n                    if (files.length == 0) evt.target.value = files;\n//                if (evt.target && evt.target.getAttribute('__ngf_gen__')) {\n//                    angular.element(evt.target).remove();\n//                }\n                } finally {\n                    isUpdating = false;\n                }\n            }\n        }\n\n        function bindAttrToFileInput(fileElem) {\n            if (attr.ngfMultiple) fileElem.attr('multiple', $parse(attr.ngfMultiple)(scope));\n            if (!$parse(attr.ngfMultiple)(scope)) fileElem.attr('multiple', undefined);\n            if (attr['accept']) fileElem.attr('accept', attr['accept']);\n            if (attr.ngfCapture) fileElem.attr('capture', $parse(attr.ngfCapture)(scope));\n//        if (attr.ngDisabled) fileElem.attr('disabled', $parse(attr.disabled)(scope));\n            for (var i = 0; i < elem[0].attributes.length; i++) {\n                var attribute = elem[0].attributes[i];\n                if ((isInputTypeFile() && attribute.name !== 'type')\n                    || (attribute.name !== 'type' && attribute.name !== 'class' &&\n                    attribute.name !== 'id' && attribute.name !== 'style')) {\n                    fileElem.attr(attribute.name, attribute.value);\n                }\n            }\n        }\n\n        function createFileInput(evt) {\n            if (elem.attr('disabled')) {\n                return;\n            }\n            var fileElem = angular.element('<input type=\"file\">');\n            bindAttrToFileInput(fileElem);\n\n            if (isInputTypeFile()) {\n                elem.replaceWith(fileElem);\n                elem = fileElem;\n                fileElem.attr('__ngf_gen__', true);\n                $compile(elem)(scope);\n            } else {\n                fileElem.css('visibility', 'hidden').css('position', 'absolute')\n                    .css('width', '1').css('height', '1').css('z-index', '-100000')\n                    .attr('tabindex', '-1');\n                if (elem.__ngf_ref_elem__) {elem.__ngf_ref_elem__.remove();}\n                elem.__ngf_ref_elem__ = fileElem;\n                document.body.appendChild(fileElem[0]);\n            }\n\n            return fileElem;\n        }\n\n        function resetModel(evt) {\n            updateModel($parse, $timeout, scope, ngModel, attr, attr.ngfChange || attr.ngfSelect, [], [], evt, true);\n        }\n\n        function clickHandler(evt) {\n            if (evt != null) {\n                evt.preventDefault();\n                evt.stopPropagation();\n            }\n            var fileElem = createFileInput(evt);\n            if (fileElem) {\n                fileElem.bind('change', changeFn);\n                if (evt) {\n                    resetModel(evt);\n                }\n\n                function clickAndAssign(evt) {\n                    if (evt != null) {\n                        fileElem[0].click();\n                    }\n                    if (isInputTypeFile()) {\n                        elem.bind('click touchend', clickHandler);\n                    }\n                }\n\n                // fix for android native browser\n                if (navigator.userAgent.toLowerCase().match(/android/)) {\n                    setTimeout(function() {\n                        clickAndAssign(evt);\n                    }, 0);\n                } else {\n                    clickAndAssign(evt);\n                }\n            }\n            return false;\n        }\n\n        if (window.FileAPI && window.FileAPI.ngfFixIE) {\n            window.FileAPI.ngfFixIE(elem, createFileInput, bindAttrToFileInput, changeFn, resetModel);\n        } else {\n            clickHandler();\n            if (!isInputTypeFile()) {\n                elem.bind('click touchend', clickHandler);\n            }\n        }\n    }\n\n    ngFileUpload.directive('ngfDrop', ['$parse', '$timeout', '$location', function ($parse, $timeout, $location) {\n        return {\n            restrict: 'AEC',\n            require: '?ngModel',\n            link: function (scope, elem, attr, ngModel) {\n                linkDrop(scope, elem, attr, ngModel, $parse, $timeout, $location);\n            }\n        }\n    }]);\n\n    ngFileUpload.directive('ngfNoFileDrop', function () {\n        return function (scope, elem) {\n            if (dropAvailable()) elem.css('display', 'none')\n        }\n    });\n\n    ngFileUpload.directive('ngfDropAvailable', ['$parse', '$timeout', function ($parse, $timeout) {\n        return function (scope, elem, attr) {\n            if (dropAvailable()) {\n                var fn = $parse(attr.ngfDropAvailable);\n                $timeout(function () {\n                    fn(scope);\n                    if (fn.assign) {\n                        fn.assign(scope, true);\n                    }\n                });\n            }\n        }\n    }]);\n\n    function linkDrop(scope, elem, attr, ngModel, $parse, $timeout, $location) {\n        var available = dropAvailable();\n        if (attr.dropAvailable) {\n            $timeout(function () {\n                scope[attr.dropAvailable] ? scope[attr.dropAvailable].value = available : scope[attr.dropAvailable] = available;\n            });\n        }\n        if (!available) {\n            if ($parse(attr.ngfHideOnDropNotAvailable)(scope) == true) {\n                elem.css('display', 'none');\n            }\n            return;\n        }\n        var leaveTimeout = null;\n        var stopPropagation = $parse(attr.ngfStopPropagation);\n        var dragOverDelay = 1;\n        var accept = $parse(attr.ngfAccept);\n        var actualDragOverClass;\n\n        elem[0].addEventListener('dragover', function (evt) {\n            if (elem.attr('disabled')) return;\n            evt.preventDefault();\n            if (stopPropagation(scope)) evt.stopPropagation();\n            // handling dragover events from the Chrome download bar\n            if (navigator.userAgent.indexOf(\"Chrome\") > -1) {\n                var b = evt.dataTransfer.effectAllowed;\n                evt.dataTransfer.dropEffect = ('move' === b || 'linkMove' === b) ? 'move' : 'copy';\n            }\n            $timeout.cancel(leaveTimeout);\n            if (!scope.actualDragOverClass) {\n                actualDragOverClass = calculateDragOverClass(scope, attr, evt);\n            }\n            elem.addClass(actualDragOverClass);\n        }, false);\n        elem[0].addEventListener('dragenter', function (evt) {\n            if (elem.attr('disabled')) return;\n            evt.preventDefault();\n            if (stopPropagation(scope)) evt.stopPropagation();\n        }, false);\n        elem[0].addEventListener('dragleave', function () {\n            if (elem.attr('disabled')) return;\n            leaveTimeout = $timeout(function () {\n                elem.removeClass(actualDragOverClass);\n                actualDragOverClass = null;\n            }, dragOverDelay || 1);\n        }, false);\n        elem[0].addEventListener('drop', function (evt) {\n            if (elem.attr('disabled')) return;\n            evt.preventDefault();\n            if (stopPropagation(scope)) evt.stopPropagation();\n            elem.removeClass(actualDragOverClass);\n            actualDragOverClass = null;\n            extractFiles(evt, function (files, rejFiles) {\n                updateModel($parse, $timeout, scope, ngModel, attr,\n                    attr.ngfChange || attr.ngfDrop, files, rejFiles, evt)\n            }, $parse(attr.ngfAllowDir)(scope) != false, attr.multiple || $parse(attr.ngfMultiple)(scope));\n        }, false);\n\n        function calculateDragOverClass(scope, attr, evt) {\n            var accepted = true;\n            var items = evt.dataTransfer.items;\n            if (items != null) {\n                for (var i = 0; i < items.length && accepted; i++) {\n                    accepted = accepted\n                        && (items[i].kind == 'file' || items[i].kind == '')\n                        && validate(scope, $parse, attr, items[i], evt);\n                }\n            }\n            var clazz = $parse(attr.ngfDragOverClass)(scope, {$event: evt});\n            if (clazz) {\n                if (clazz.delay) dragOverDelay = clazz.delay;\n                if (clazz.accept) clazz = accepted ? clazz.accept : clazz.reject;\n            }\n            return clazz || attr.ngfDragOverClass || 'dragover';\n        }\n\n        function extractFiles(evt, callback, allowDir, multiple) {\n            var files = [], rejFiles = [], items = evt.dataTransfer.items, processing = 0;\n\n            function addFile(file) {\n                if (validate(scope, $parse, attr, file, evt)) {\n                    files.push(file);\n                } else {\n                    rejFiles.push(file);\n                }\n            }\n\n            if (items && items.length > 0 && $location.protocol() != 'file') {\n                for (var i = 0; i < items.length; i++) {\n                    if (items[i].webkitGetAsEntry && items[i].webkitGetAsEntry() && items[i].webkitGetAsEntry().isDirectory) {\n                        var entry = items[i].webkitGetAsEntry();\n                        if (entry.isDirectory && !allowDir) {\n                            continue;\n                        }\n                        if (entry != null) {\n                            traverseFileTree(files, entry);\n                        }\n                    } else {\n                        var f = items[i].getAsFile();\n                        if (f != null) addFile(f);\n                    }\n                    if (!multiple && files.length > 0) break;\n                }\n            } else {\n                var fileList = evt.dataTransfer.files;\n                if (fileList != null) {\n                    for (var i = 0; i < fileList.length; i++) {\n                        addFile(fileList.item(i));\n                        if (!multiple && files.length > 0) break;\n                    }\n                }\n            }\n            var delays = 0;\n            (function waitForProcess(delay) {\n                $timeout(function () {\n                    if (!processing) {\n                        if (!multiple && files.length > 1) {\n                            i = 0;\n                            while (files[i].type == 'directory') i++;\n                            files = [files[i]];\n                        }\n                        callback(files, rejFiles);\n                    } else {\n                        if (delays++ * 10 < 20 * 1000) {\n                            waitForProcess(10);\n                        }\n                    }\n                }, delay || 0)\n            })();\n\n            function traverseFileTree(files, entry, path) {\n                if (entry != null) {\n                    if (entry.isDirectory) {\n                        var filePath = (path || '') + entry.name;\n                        addFile({name: entry.name, type: 'directory', path: filePath});\n                        var dirReader = entry.createReader();\n                        var entries = [];\n                        processing++;\n                        var readEntries = function () {\n                            dirReader.readEntries(function (results) {\n                                try {\n                                    if (!results.length) {\n                                        for (var i = 0; i < entries.length; i++) {\n                                            traverseFileTree(files, entries[i], (path ? path : '') + entry.name + '/');\n                                        }\n                                        processing--;\n                                    } else {\n                                        entries = entries.concat(Array.prototype.slice.call(results || [], 0));\n                                        readEntries();\n                                    }\n                                } catch (e) {\n                                    processing--;\n                                    console.error(e);\n                                }\n                            }, function () {\n                                processing--;\n                            });\n                        };\n                        readEntries();\n                    } else {\n                        processing++;\n                        entry.file(function (file) {\n                            try {\n                                processing--;\n                                file.path = (path ? path : '') + file.name;\n                                addFile(file);\n                            } catch (e) {\n                                processing--;\n                                console.error(e);\n                            }\n                        }, function () {\n                            processing--;\n                        });\n                    }\n                }\n            }\n        }\n    }\n\n    ngFileUpload.directive('ngfSrc', ['$parse', '$timeout', function ($parse, $timeout) {\n        return {\n            restrict: 'AE',\n            link: function (scope, elem, attr, file) {\n                if (window.FileReader) {\n                    scope.$watch(attr.ngfSrc, function(file) {\n                        if (file &&\n                            validate(scope, $parse, attr, file, null) &&\n                            (!window.FileAPI || navigator.userAgent.indexOf('MSIE 8') === -1 || file.size < 20000) &&\n                            (!window.FileAPI || navigator.userAgent.indexOf('MSIE 9') === -1 || file.size < 4000000)) {\n                            $timeout(function() {\n                                //prefer URL.createObjectURL for handling refrences to files of all sizes\n                                //since it doesnÂ´t build a large string in memory\n                                var URL = window.URL || window.webkitURL;\n                                if (URL && URL.createObjectURL){\n                                    elem.attr('src', URL.createObjectURL(file));\n                                } else {\n                                    var fileReader = new FileReader();\n                                    fileReader.readAsDataURL(file);\n                                    fileReader.onload = function(e) {\n                                        $timeout(function() {\n                                            elem.attr('src', e.target.result);\n                                        });\n                                    }\n                                }\n                            });\n                        } else {\n                            elem.attr('src', attr.ngfDefaultSrc || '');\n                        }\n                    });\n                }\n            }\n        }\n    }]);\n\n    function dropAvailable() {\n        var div = document.createElement('div');\n        return ('draggable' in div) && ('ondrop' in div);\n    }\n\n    function updateModel($parse, $timeout, scope, ngModel, attr, fileChange, files, rejFiles, evt, noDelay) {\n        function update() {\n            if (ngModel) {\n                $parse(attr.ngModel).assign(scope, files);\n                $timeout(function () {\n                    ngModel && ngModel.$setViewValue(files != null && files.length == 0 ? null : files);\n                });\n            }\n            if (attr.ngModelRejected) {\n                $parse(attr.ngModelRejected).assign(scope, rejFiles);\n            }\n            if (fileChange) {\n                $parse(fileChange)(scope, {\n                    $files: files,\n                    $rejectedFiles: rejFiles,\n                    $event: evt\n                });\n\n            }\n        }\n        if (noDelay) {\n            update();\n        } else {\n            $timeout(function () {\n                update();\n            });\n        }\n    }\n\n    function validate(scope, $parse, attr, file, evt) {\n        var accept = $parse(attr.ngfAccept)(scope, {$file: file, $event: evt});\n        var fileSizeMax = $parse(attr.ngfMaxSize)(scope, {$file: file, $event: evt}) || 9007199254740991;\n        var fileSizeMin = $parse(attr.ngfMinSize)(scope, {$file: file, $event: evt}) || -1;\n        if (accept != null && angular.isString(accept)) {\n            var regexp = new RegExp(globStringToRegex(accept), 'gi');\n            accept = (file.type != null && regexp.test(file.type.toLowerCase())) ||\n                (file.name != null && regexp.test(file.name.toLowerCase()));\n        }\n        return (accept == null || accept) && (file.size == null || (file.size < fileSizeMax && file.size > fileSizeMin));\n    }\n\n    function globStringToRegex(str) {\n        if (str.length > 2 && str[0] === '/' && str[str.length - 1] === '/') {\n            return str.substring(1, str.length - 1);\n        }\n        var split = str.split(','), result = '';\n        if (split.length > 1) {\n            for (var i = 0; i < split.length; i++) {\n                result += '(' + globStringToRegex(split[i]) + ')';\n                if (i < split.length - 1) {\n                    result += '|'\n                }\n            }\n        } else {\n            if (str.indexOf('.') == 0) {\n                str = '*' + str;\n            }\n            result = '^' + str.replace(new RegExp('[.\\\\\\\\+*?\\\\[\\\\^\\\\]$(){}=!<>|:\\\\' + '-]', 'g'), '\\\\$&') + '$';\n            result = result.replace(/\\\\\\*/g, '.*').replace(/\\\\\\?/g, '.');\n        }\n        return result;\n    }\n\n})();\n\n/**!\n * AngularJS file upload/drop directive and service with progress and abort\n * FileAPI Flash shim for old browsers not supporting FormData\n * @author  Danial  <danial.farid@gmail.com>\n * @version 4.2.4\n */\n\n(function() {\n\n    var hasFlash = function() {\n        try {\n            var fo = new ActiveXObject('ShockwaveFlash.ShockwaveFlash');\n            if (fo) return true;\n        } catch(e) {\n            if (navigator.mimeTypes['application/x-shockwave-flash'] != undefined) return true;\n        }\n        return false;\n    }\n\n    function patchXHR(fnName, newFn) {\n        window.XMLHttpRequest.prototype[fnName] = newFn(window.XMLHttpRequest.prototype[fnName]);\n    };\n\n    if ((window.XMLHttpRequest && !window.FormData) || (window.FileAPI && FileAPI.forceLoad)) {\n        var initializeUploadListener = function(xhr) {\n            if (!xhr.__listeners) {\n                if (!xhr.upload) xhr.upload = {};\n                xhr.__listeners = [];\n                var origAddEventListener = xhr.upload.addEventListener;\n                xhr.upload.addEventListener = function(t, fn, b) {\n                    xhr.__listeners[t] = fn;\n                    origAddEventListener && origAddEventListener.apply(this, arguments);\n                };\n            }\n        }\n\n        patchXHR('open', function(orig) {\n            return function(m, url, b) {\n                initializeUploadListener(this);\n                this.__url = url;\n                try {\n                    orig.apply(this, [m, url, b]);\n                } catch (e) {\n                    if (e.message.indexOf('Access is denied') > -1) {\n                        this.__origError = e;\n                        orig.apply(this, [m, '_fix_for_ie_crossdomain__', b]);\n                    }\n                }\n            }\n        });\n\n        patchXHR('getResponseHeader', function(orig) {\n            return function(h) {\n                return this.__fileApiXHR && this.__fileApiXHR.getResponseHeader ? this.__fileApiXHR.getResponseHeader(h) : (orig == null ? null : orig.apply(this, [h]));\n            };\n        });\n\n        patchXHR('getAllResponseHeaders', function(orig) {\n            return function() {\n                return this.__fileApiXHR && this.__fileApiXHR.getAllResponseHeaders ? this.__fileApiXHR.getAllResponseHeaders() : (orig == null ? null : orig.apply(this));\n            }\n        });\n\n        patchXHR('abort', function(orig) {\n            return function() {\n                return this.__fileApiXHR && this.__fileApiXHR.abort ? this.__fileApiXHR.abort() : (orig == null ? null : orig.apply(this));\n            }\n        });\n\n        patchXHR('setRequestHeader', function(orig) {\n            return function(header, value) {\n                if (header === '__setXHR_') {\n                    initializeUploadListener(this);\n                    var val = value(this);\n                    // fix for angular < 1.2.0\n                    if (val instanceof Function) {\n                        val(this);\n                    }\n                } else {\n                    this.__requestHeaders = this.__requestHeaders || {};\n                    this.__requestHeaders[header] = value;\n                    orig.apply(this, arguments);\n                }\n            }\n        });\n\n        function redefineProp(xhr, prop, fn) {\n            try {\n                Object.defineProperty(xhr, prop, {get: fn});\n            } catch (e) {/*ignore*/}\n        }\n\n        patchXHR('send', function(orig) {\n            return function() {\n                var xhr = this;\n                if (arguments[0] && arguments[0].__isFileAPIShim) {\n                    var formData = arguments[0];\n                    var config = {\n                        url: xhr.__url,\n                        jsonp: false, //removes the callback form param\n                        cache: true, //removes the ?fileapiXXX in the url\n                        complete: function(err, fileApiXHR) {\n                            xhr.__completed = true;\n                            if (!err && xhr.__listeners['load'])\n                                xhr.__listeners['load']({type: 'load', loaded: xhr.__loaded, total: xhr.__total, target: xhr, lengthComputable: true});\n                            if (!err && xhr.__listeners['loadend'])\n                                xhr.__listeners['loadend']({type: 'loadend', loaded: xhr.__loaded, total: xhr.__total, target: xhr, lengthComputable: true});\n                            if (err === 'abort' && xhr.__listeners['abort'])\n                                xhr.__listeners['abort']({type: 'abort', loaded: xhr.__loaded, total: xhr.__total, target: xhr, lengthComputable: true});\n                            if (fileApiXHR.status !== undefined) redefineProp(xhr, 'status', function() {return (fileApiXHR.status == 0 && err && err !== 'abort') ? 500 : fileApiXHR.status});\n                            if (fileApiXHR.statusText !== undefined) redefineProp(xhr, 'statusText', function() {return fileApiXHR.statusText});\n                            redefineProp(xhr, 'readyState', function() {return 4});\n                            if (fileApiXHR.response !== undefined) redefineProp(xhr, 'response', function() {return fileApiXHR.response});\n                            var resp = fileApiXHR.responseText || (err && fileApiXHR.status == 0 && err !== 'abort' ? err : undefined);\n                            redefineProp(xhr, 'responseText', function() {return resp});\n                            redefineProp(xhr, 'response', function() {return resp});\n                            if (err) redefineProp(xhr, 'err', function() {return err});\n                            xhr.__fileApiXHR = fileApiXHR;\n                            if (xhr.onreadystatechange) xhr.onreadystatechange();\n                            if (xhr.onload) xhr.onload();\n                        },\n                        progress: function(e) {\n                            e.target = xhr;\n                            xhr.__listeners['progress'] && xhr.__listeners['progress'](e);\n                            xhr.__total = e.total;\n                            xhr.__loaded = e.loaded;\n                            if (e.total === e.loaded) {\n                                // fix flash issue that doesn't call complete if there is no response text from the server\n                                var _this = this\n                                setTimeout(function() {\n                                    if (!xhr.__completed) {\n                                        xhr.getAllResponseHeaders = function(){};\n                                        _this.complete(null, {status: 204, statusText: 'No Content'});\n                                    }\n                                }, FileAPI.noContentTimeout || 10000);\n                            }\n                        },\n                        headers: xhr.__requestHeaders\n                    }\n                    config.data = {};\n                    config.files = {}\n                    for (var i = 0; i < formData.data.length; i++) {\n                        var item = formData.data[i];\n                        if (item.val != null && item.val.name != null && item.val.size != null && item.val.type != null) {\n                            config.files[item.key] = item.val;\n                        } else {\n                            config.data[item.key] = item.val;\n                        }\n                    }\n\n                    setTimeout(function() {\n                        if (!hasFlash()) {\n                            throw 'Adode Flash Player need to be installed. To check ahead use \"FileAPI.hasFlash\"';\n                        }\n                        xhr.__fileApiXHR = FileAPI.upload(config);\n                    }, 1);\n                } else {\n                    if (this.__origError) {\n                        throw this.__origError;\n                    }\n                    orig.apply(xhr, arguments);\n                }\n            }\n        });\n        window.XMLHttpRequest.__isFileAPIShim = true;\n\n        function isInputTypeFile(elem) {\n            return elem[0].tagName.toLowerCase() === 'input' && elem.attr('type') && elem.attr('type').toLowerCase() === 'file';\n        }\n\n        window.FormData = FormData = function() {\n            return {\n                append: function(key, val, name) {\n                    if (val.__isFileAPIBlobShim) {\n                        val = val.data[0];\n                    }\n                    this.data.push({\n                        key: key,\n                        val: val,\n                        name: name\n                    });\n                },\n                data: [],\n                __isFileAPIShim: true\n            };\n        };\n\n        window.Blob = Blob = function(b) {\n            return {\n                data: b,\n                __isFileAPIBlobShim: true\n            };\n        };\n\n        (function () {\n            //load FileAPI\n            if (!window.FileAPI) {\n                window.FileAPI = {};\n            }\n            if (FileAPI.forceLoad) {\n                FileAPI.html5 = false;\n            }\n\n            if (!FileAPI.upload) {\n                var jsUrl, basePath, script = document.createElement('script'), allScripts = document.getElementsByTagName('script'), i, index, src;\n                if (window.FileAPI.jsUrl) {\n                    jsUrl = window.FileAPI.jsUrl;\n                } else if (window.FileAPI.jsPath) {\n                    basePath = window.FileAPI.jsPath;\n                } else {\n                    for (i = 0; i < allScripts.length; i++) {\n                        src = allScripts[i].src;\n                        index = src.search(/\\/ng\\-file\\-upload[\\-a-zA-z0-9\\.]*\\.js/)\n                        if (index > -1) {\n                            basePath = src.substring(0, index + 1);\n                            break;\n                        }\n                    }\n                }\n\n                if (FileAPI.staticPath == null) FileAPI.staticPath = basePath;\n                script.setAttribute('src', jsUrl || basePath + 'FileAPI.min.js');\n                document.getElementsByTagName('head')[0].appendChild(script);\n                FileAPI.hasFlash = hasFlash();\n            }\n        })();\n\n        FileAPI.ngfFixIE = function(elem, createFileElemFn, bindAttr, changeFn, resetModel) {\n            if (!hasFlash()) {\n                throw 'Adode Flash Player need to be installed. To check ahead use \"FileAPI.hasFlash\"';\n            }\n            var makeFlashInput = function(evt) {\n                if (elem.attr('disabled')) {\n                    elem.__ngf_elem__.removeClass('js-fileapi-wrapper');\n                } else {\n                    var fileElem = elem.__ngf_elem__;\n                    if (!fileElem) {\n                        fileElem = elem.__ngf_elem__ = createFileElemFn();\n                        fileElem.addClass('js-fileapi-wrapper');\n                        if (!isInputTypeFile(elem)) {\n//\t\t\t\t\t\tif (fileElem.parent().css('position') === '' || fileElem.parent().css('position') === 'static') {\n//\t\t\t\t\t\t\tfileElem.parent().css('position', 'relative');\n//\t\t\t\t\t\t}\n//\t\t\t\t\t\telem.parent()[0].insertBefore(fileElem[0], elem[0]);\n//\t\t\t\t\t\telem.css('overflow', 'hidden');\n                        }\n                        setTimeout(function() {\n                            fileElem.bind('mouseenter', makeFlashInput);\n                        }, 10);\n                        fileElem.bind('change', function(evt) {\n                            fileApiChangeFn.apply(this, [evt]);\n                            changeFn.apply(this, [evt]);\n//\t\t\t\t\t\talert('change' +  evt);\n                        });\n                    } else {\n                        bindAttr(elem.__ngf_elem__);\n                    }\n                    if (!isInputTypeFile(elem)) {\n                        fileElem.css('position', 'absolute')\n                            .css('top', getOffset(elem[0]).top + 'px').css('left', getOffset(elem[0]).left + 'px')\n                            .css('width', elem[0].offsetWidth + 'px').css('height', elem[0].offsetHeight + 'px')\n                            .css('filter', 'alpha(opacity=0)').css('display', elem.css('display'))\n                            .css('overflow', 'hidden').css('z-index', '900000')\n                            .css('visibility', 'visible');\n                    }\n                }\n                function getOffset(obj) {\n                    var left, top;\n                    left = top = 0;\n                    if (obj.offsetParent) {\n                        do {\n                            left += obj.offsetLeft;\n                            top  += obj.offsetTop;\n                        } while (obj = obj.offsetParent);\n                    }\n                    return {\n                        left : left,\n                        top : top\n                    };\n                };\n            };\n\n            elem.bind('mouseenter', makeFlashInput);\n\n            var fileApiChangeFn = function(evt) {\n                var files = FileAPI.getFiles(evt);\n                //just a double check for #233\n                for (var i = 0; i < files.length; i++) {\n                    if (files[i].size === undefined) files[i].size = 0;\n                    if (files[i].name === undefined) files[i].name = 'file';\n                    if (files[i].type === undefined) files[i].type = 'undefined';\n                }\n                if (!evt.target) {\n                    evt.target = {};\n                }\n                evt.target.files = files;\n                // if evt.target.files is not writable use helper field\n                if (evt.target.files != files) {\n                    evt.__files_ = files;\n                }\n                (evt.__files_ || evt.target.files).item = function(i) {\n                    return (evt.__files_ || evt.target.files)[i] || null;\n                };\n            };\n        };\n\n        FileAPI.disableFileInput = function(elem, disable) {\n            if (disable) {\n                elem.removeClass('js-fileapi-wrapper')\n            } else {\n                elem.addClass('js-fileapi-wrapper');\n            }\n        };\n    }\n\n\n    if (!window.FileReader) {\n        window.FileReader = function() {\n            var _this = this, loadStarted = false;\n            this.listeners = {};\n            this.addEventListener = function(type, fn) {\n                _this.listeners[type] = _this.listeners[type] || [];\n                _this.listeners[type].push(fn);\n            };\n            this.removeEventListener = function(type, fn) {\n                _this.listeners[type] && _this.listeners[type].splice(_this.listeners[type].indexOf(fn), 1);\n            };\n            this.dispatchEvent = function(evt) {\n                var list = _this.listeners[evt.type];\n                if (list) {\n                    for (var i = 0; i < list.length; i++) {\n                        list[i].call(_this, evt);\n                    }\n                }\n            };\n            this.onabort = this.onerror = this.onload = this.onloadstart = this.onloadend = this.onprogress = null;\n\n            var constructEvent = function(type, evt) {\n                var e = {type: type, target: _this, loaded: evt.loaded, total: evt.total, error: evt.error};\n                if (evt.result != null) e.target.result = evt.result;\n                return e;\n            };\n            var listener = function(evt) {\n                if (!loadStarted) {\n                    loadStarted = true;\n                    _this.onloadstart && _this.onloadstart(constructEvent('loadstart', evt));\n                }\n                if (evt.type === 'load') {\n                    _this.onloadend && _this.onloadend(constructEvent('loadend', evt));\n                    var e = constructEvent('load', evt);\n                    _this.onload && _this.onload(e);\n                    _this.dispatchEvent(e);\n                } else if (evt.type === 'progress') {\n                    var e = constructEvent('progress', evt);\n                    _this.onprogress && _this.onprogress(e);\n                    _this.dispatchEvent(e);\n                } else {\n                    var e = constructEvent('error', evt);\n                    _this.onerror && _this.onerror(e);\n                    _this.dispatchEvent(e);\n                }\n            };\n            this.readAsArrayBuffer = function(file) {\n                FileAPI.readAsBinaryString(file, listener);\n            }\n            this.readAsBinaryString = function(file) {\n                FileAPI.readAsBinaryString(file, listener);\n            }\n            this.readAsDataURL = function(file) {\n                FileAPI.readAsDataURL(file, listener);\n            }\n            this.readAsText = function(file) {\n                FileAPI.readAsText(file, listener);\n            }\n        }\n    }\n})();"],"sourceRoot":"/source/"}