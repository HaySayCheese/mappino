var mappino;!function(t){var e;!function(t){var e;!function(t){var e=function(){function t(){}return Object.defineProperty(t,"Default",{get:function(){return[{id:"0",name:"other",title:"Другой"},{id:"1",name:"not_defined",title:"Панель"},{id:"2",name:"not_defined",title:"Кирпич"},{id:"3",name:"not_defined",title:"Хрущевка"},{id:"4",name:"not_defined",title:"Монолит"},{id:"5",name:"not_defined",title:"Дореволюционний"},{id:"6",name:"not_defined",title:"Малосемейка"},{id:"7",name:"not_defined",title:"Индивидуальный проект"},{id:"8",name:"not_defined",title:"Неизвестно"}]},enumerable:!0,configurable:!0}),t}();t.BuildingTypesConstant=e}(e=t.constants||(t.constants={}))}(e=t.core||(t.core={}))}(mappino||(mappino={}));var mappino;!function(t){var e;!function(t){var e;!function(t){var e=function(){function t(){}return Object.defineProperty(t,"Default",{get:function(){return[{id:"0",name:"not_defined",title:"Косметический ремонт"},{id:"1",name:"not_defined",title:"Жилое"},{id:"2",name:"not_defined",title:"Евроремонт"},{id:"3",name:"not_defined",title:"Дизайнерский ремонт"},{id:"4",name:"not_defined",title:"Требуется косметический ремонт"},{id:"5",name:"not_defined",title:"Неоконченный ремонт"},{id:"6",name:"not_defined",title:"Под чистовую отделку"}]},enumerable:!0,configurable:!0}),t}();t.ConditionTypesConstant=e}(e=t.constants||(t.constants={}))}(e=t.core||(t.core={}))}(mappino||(mappino={}));var mappino;!function(t){var e;!function(t){var e;!function(t){var e=function(){function t(){}return Object.defineProperty(t,"Default",{get:function(){return[{id:"0",name:"USD",title:"Дол."},{id:"1",name:"EUR",title:"Евро"},{id:"2",name:"UAH",title:"Грн."}]},enumerable:!0,configurable:!0}),t}();t.CurrencyTypesConstant=e}(e=t.constants||(t.constants={}))}(e=t.core||(t.core={}))}(mappino||(mappino={}));var mappino;!function(t){var e;!function(t){var e;!function(t){var e=function(){function t(){}return Object.defineProperty(t,"Default",{get:function(){return[{id:"0",name:"other",title:"Другой"},{id:"1",name:"not_defined",title:"Малосемейка"},{id:"2",name:"not_defined",title:"Отдельная"},{id:"3",name:"not_defined",title:"Коммунальная"},{id:"4",name:"not_defined",title:"Двухуровневая"},{id:"5",name:"not_defined",title:"Студия"}]},enumerable:!0,configurable:!0}),t}();t.FlatTypesConstant=e}(e=t.constants||(t.constants={}))}(e=t.core||(t.core={}))}(mappino||(mappino={}));var mappino;!function(t){var e;!function(t){var e;!function(t){var e=function(){function t(){}return Object.defineProperty(t,"Default",{get:function(){return[{id:"0",name:"not_defined",title:"Этаж"},{id:"1",name:"not_defined",title:"Мансарда"},{id:"2",name:"not_defined",title:"Цоколь"}]},enumerable:!0,configurable:!0}),t}();t.FloorTypesConstant=e}(e=t.constants||(t.constants={}))}(e=t.core||(t.core={}))}(mappino||(mappino={}));var mappino;!function(t){var e;!function(t){var e;!function(t){var e=function(){function t(){}return Object.defineProperty(t,"Default",{get:function(){return[{id:"0",name:"not_defined",title:"Другой"},{id:"1",name:"not_defined",title:"Индивидуальное"},{id:"2",name:"not_defined",title:"Центральное"},{id:"3",name:"not_defined",title:"Не известно"},{id:"4",name:"not_defined",title:"Отсутсвует"}]},enumerable:!0,configurable:!0}),Object.defineProperty(t,"Individual",{get:function(){return[{id:"0",name:"not_defined",title:"Другой"},{id:"1",name:"not_defined",title:"Электричество"},{id:"2",name:"not_defined",title:"Газ"},{id:"3",name:"not_defined",title:"Дрова"}]},enumerable:!0,configurable:!0}),t}();t.HeatingTypesConstant=e}(e=t.constants||(t.constants={}))}(e=t.core||(t.core={}))}(mappino||(mappino={}));var mappino;!function(t){var e;!function(t){var e;!function(t){var e=function(){function t(){}return Object.defineProperty(t,"Default",{get:function(){return[{id:"0",name:"new_building",title:"Новостройка"},{id:"1",name:"secondary_market",title:"Вторичный рынок"}]},enumerable:!0,configurable:!0}),t}();t.MarketTypesConstant=e}(e=t.constants||(t.constants={}))}(e=t.core||(t.core={}))}(mappino||(mappino={}));var mappino;!function(t){var e;!function(t){var e;!function(t){var e=function(){function t(){}return Object.defineProperty(t,"Default",{get:function(){return[{id:"0",name:"daily",title:"Посуточно"},{id:"1",name:"monthly",title:"Помесячно"},{id:"2",name:"long_term",title:"Долгосрочная"}]},enumerable:!0,configurable:!0}),t}();t.PeriodTypesConstant=e}(e=t.constants||(t.constants={}))}(e=t.core||(t.core={}))}(mappino||(mappino={}));var mappino;!function(t){var e;!function(t){var e;!function(t){var e=function(){function t(){}return Object.defineProperty(t,"Default",{get:function(){return[{id:"0",name:"flat",title:"Квартиры",filters:["op_sid","pr_sid","p_min","p_max","cu_sid","p_c_min","p_c_max","n_b","s_m","fml","frg","r_c_min","r_c_max","t_a_min","t_a_max","f_min","f_max","msd","grd","pl_sid","lft","elt","h_w","c_w","gas","h_t_sid"]},{id:"1",name:"house",title:"Дома",filters:["op_sid","pr_sid","p_min","p_max","cu_sid","p_c_min","p_c_max","n_b","s_m","fml","frg","r_c_min","r_c_max","f_c_min","f_c_max","elt","h_w","gas","c_w","swg","h_t_sid"]},{id:"2",name:"room",title:"Комнаты",filters:["op_sid","pr_sid","p_min","p_max","cu_sid","p_c_min","p_c_max","n_b","s_m","fml","frg","r_c_min","r_c_max","t_a_min","t_a_max","f_min","f_max","msd","grd","lft","elt","h_w","c_w","gas","h_t_sid"]},{id:"3",name:"land",title:"Земельные участки",filters:["op_sid","p_min","p_max","cu_sid","a_min","a_max","gas","elt","wtr","swg"]},{id:"4",name:"garage",title:"Гаражи",filters:["op_sid","p_min","p_max","cu_sid","t_a_min","t_a_max"]},{id:"5",name:"office",title:"Офисы",filters:["op_sid","p_min","p_max","cu_sid","n_b","s_m","t_a_min","t_a_max","c_c_min","c_c_max","sct","ktn","h_w","c_w"]},{id:"6",name:"trade",title:"Торговые помещения",filters:["op_sid","p_min","p_max","cu_sid","n_b","s_m","h_a_min","h_a_max","t_a_min","t_a_max","b_t_sid","gas","elt","h_w","c_w","swg"]},{id:"7",name:"warehouse",title:"Склады",filters:["op_sid","p_min","p_max","cu_sid","n_b","s_m","h_a_min","h_a_max","gas","elt","h_w","c_w","s_a","f_a"]},{id:"8",name:"business",title:"Готовый бизнес",filters:["op_sid","p_min","p_max","cu_sid"]}]},enumerable:!0,configurable:!0}),t}();t.RealtyTypesConstant=e}(e=t.constants||(t.constants={}))}(e=t.core||(t.core={}))}(mappino||(mappino={}));var mappino;!function(t){var e;!function(t){var e;!function(t){var e=function(){function t(){}return Object.defineProperty(t,"Default",{get:function(){return[{id:"0",name:"other",title:"Смежная"},{id:"1",name:"not_defined",title:"Раздельная"},{id:"2",name:"not_defined",title:"Раздельно-смежная"},{id:"3",name:"not_defined",title:"Свободная планировка"}]},enumerable:!0,configurable:!0}),t}();t.RoomPlanningTypesConstant=e}(e=t.constants||(t.constants={}))}(e=t.core||(t.core={}))}(mappino||(mappino={}));var mappino;!function(t){var e;!function(t){var e;!function(t){var e=angular.module("mappino.core.constants",[]);e.constant("CONSTANTS",{BUILDING_TYPES:t.BuildingTypesConstant.Default,CONDITION_TYPES:t.ConditionTypesConstant.Default,CURRENCY_TYPES:t.CurrencyTypesConstant.Default,FLAT_TYPES:t.FlatTypesConstant.Default,FLOOR_TYPES:t.FloorTypesConstant.Default,HEATING_TYPES:t.HeatingTypesConstant.Default,INDIVIDUAL_HEATING_TYPES:t.HeatingTypesConstant.Individual,MARKET_TYPES:t.MarketTypesConstant.Default,PERIOD_TYPES:t.PeriodTypesConstant.Default,REALTY_TYPES:t.RealtyTypesConstant.Default,ROOM_PLANNING_TYPES:t.RoomPlanningTypesConstant.Default}),e.run(["$rootScope","CONSTANTS",function(t,e){t.CONSTANTS=e}])}(e=t.constants||(t.constants={}))}(e=t.core||(t.core={}))}(mappino||(mappino={}));var mappino;!function(t){var e;!function(t){var e;!function(t){function e(){return{restrict:"A",require:"ngModel",link:function(t,e,n,i){i.$parsers.push(function(t){if(void 0===t)return"";var e=t.replace(/[^0-9]/g,"");return e!==t&&(i.$setViewValue(e),i.$render()),e})}}}t.onlyNumber=e}(e=t.directives||(t.directives={}))}(e=t.core||(t.core={}))}(mappino||(mappino={}));var mappino;!function(t){var e;!function(t){var e;!function(t){var e=angular.module("mappino.core.directives",[]);e.directive("onlyNumber",t.onlyNumber)}(e=t.directives||(t.directives={}))}(e=t.core||(t.core={}))}(mappino||(mappino={}));var mappino;!function(t){var e;!function(t){var e;!function(t){var e=function(){function t(t,e,n){this.$http=t,this.$cookies=e,this.Upload=n,this._user={account:{first_name:null,last_name:null,full_name:null,avatar_url:null,add_landline_phone:null,add_mobile_phone:null,email:null,landline_phone:null,mobile_phone:null,skype:null,work_email:null},preferences:{allow_call_requests:!0,allow_messaging:!0,hide_add_landline_phone_number:!0,hide_add_mobile_phone_number:!0,hide_email:!0,hide_landline_phone_number:!0,hide_mobile_phone_number:!0,hide_skype:!0,send_call_request_notifications_to_sid:0,send_message_notifications_to_sid:0}}}return t.prototype.checkPhoneNumber=function(t,e,n){this.$http.post("/ajax/api/accounts/login/",{phone_number:t}).then(function(t){0===t.data.code?_.isFunction(e)&&e(t.data):_.isFunction(n)&&n(t.data)},function(t){_.isFunction(n)&&n(t.data)})},t.prototype.checkSMSCode=function(t,e,n,i){var o=this;this.$http.post("/ajax/api/accounts/login/check-code/",{phone_number:t,token:e}).then(function(t){0===t.data.code?(o.updateProfileField(t.data.data),o.$cookies.remove("mcheck"),_.isFunction(n)&&n(t.data)):(o.clearUserFromStorage(),_.isFunction(i)&&i(t.data))},function(t){o.clearUserFromStorage(),_.isFunction(i)&&i(t.data)})},t.prototype.tryLogin=function(t,e){var n=this;this.$http.get("/ajax/api/accounts/on-login-info/").then(function(i){0===i.data.code?(n.updateProfileField(i.data.data),_.isFunction(t)&&t(i.data)):(n.clearUserFromStorage(),_.isFunction(e)&&e(i.data))},function(t){_.isFunction(e)&&e(t.data)})},t.prototype.loadProfile=function(t,e){var n=this;this.$http.get("/ajax/api/cabinet/account/").then(function(i){0===i.data.code?(n.updateProfileField(i.data.data.account),n.updateProfileField(i.data.data.preferences),_.isFunction(t)&&t(n._user)):_.isFunction(e)&&e(i.data)},function(t){_.isFunction(e)&&e(t.data)})},t.prototype.checkProfileField=function(t,e,n){var i=this;this.$http.post("/ajax/api/cabinet/account/",t).then(function(o){if(0===o.data.code){t.v=o.data.value?o.data.value:t.v;var a={};a[t.f]=t.v,i.updateProfileField(a),_.isFunction(e)&&e(t.v)}else _.isFunction(n)&&n(o.data)},function(t){_.isFunction(n)&&n(t.data)})},t.prototype.uploadAvatar=function(t,e,n){var i=this;this.Upload.upload({url:"/ajax/api/cabinet/account/photo/",file:t}).success(function(t){0===t.code?(i.updateProfileField({avatar_url:t.data.url}),_.isFunction(e)&&e(t)):_.isFunction(n)&&n(t)}).error(function(t){_.isFunction(n)&&n(t)})},t.prototype.updateProfileField=function(t){for(var e in t)void 0!==this._user.account[e]&&(this._user.account[e]=t[e],("first_name"===e||"last_name"===e)&&(this._user.account.full_name=this._user.account.first_name+" "+this._user.account.last_name)),void 0!=this._user.preferences[e]&&(this._user.preferences[e]=t[e]);this.saveUserToStorage(this._user)},Object.defineProperty(t.prototype,"user",{get:function(){return this._user},enumerable:!0,configurable:!0}),t.prototype.clearUserFromStorage=function(){localStorage&&localStorage.user&&delete localStorage.user},t.prototype.saveUserToStorage=function(t){localStorage&&(localStorage.user=JSON.stringify(t))},t.$inject=["$http","$cookies","Upload"],t}();t.AuthService=e}(e=t.auth||(t.auth={}))}(e=t.core||(t.core={}))}(mappino||(mappino={}));var mappino;!function(t){var e;!function(t){var e;!function(t){"use strict";var e=angular.module("mappino.core.auth",["ngCookies"]);e.service("AuthService",t.AuthService)}(e=t.auth||(t.auth={}))}(e=t.core||(t.core={}))}(mappino||(mappino={}));var mappino;!function(t){var e;!function(t){angular.module("mappino.core",["mappino.core.constants","mappino.core.directives","mappino.core.auth"])}(e=t.core||(t.core={}))}(mappino||(mappino={}));var mappino;!function(t){var e;!function(t){"use strict";var e=function(){function t(t){this.app=t,t.config(["$interpolateProvider","$locationProvider",function(t,e){t.startSymbol("[["),t.endSymbol("]]")}])}return t}();t.ProvidersConfigs=e}(e=t.cabinet||(t.cabinet={}))}(mappino||(mappino={}));var mappino;!function(t){var e;!function(t){"use strict";var e=function(){function t(t){this.app=t,t.config(["$stateProvider","$urlRouterProvider","$locationProvider",function(t,e,n){e.otherwise("/publications/"),t.state("publications",{url:"/publications/",templateUrl:"/ajax/template/cabinet/publications/briefs/"}).state("publication_view",{url:"/publication/:id/view/",templateUrl:"/ajax/template/cabinet/publications/publication/"}).state("publication_edit",{url:"/publication/:id/edit/",templateUrl:"/ajax/template/cabinet/publications/publication/"}).state("support",{url:"/support/",templateUrl:"/ajax/template/cabinet/support/"}).state("ticket_view",{url:"/support/:ticket_id",templateUrl:"/ajax/template/cabinet/support/ticket/"}).state("settings",{url:"/settings/",templateUrl:"/ajax/template/cabinet/settings/"}),n.hashPrefix("!")}])}return t}();t.RouterConfigs=e}(e=t.cabinet||(t.cabinet={}))}(mappino||(mappino={}));var mappino;!function(t){var e;!function(t){"use strict";var e=function(){function t(t){this.app=t,t.config(["$mdThemingProvider",function(t){t.setDefaultTheme("blue"),t.theme("blue").primaryPalette("blue")}])}return t}();t.MaterialConfigs=e}(e=t.cabinet||(t.cabinet={}))}(mappino||(mappino={}));var mappino;!function(t){var e;!function(t){"use strict";var e=function(){function t(t){this.app=t}return t}();t.ApplicationConfigs=e}(e=t.cabinet||(t.cabinet={}))}(mappino||(mappino={}));var mappino;!function(t){var e;!function(t){var e=function(){function t(t,e){this.$http=t,this.$state=e}return t.prototype.load=function(t,e){var n=this;this.$http.get("/ajax/api/cabinet/publications/briefs/all/").then(function(i){0===i.data.code?(n._publications=i.data.data,_.isFunction(t)&&t(n._publications)):_.isFunction(e)&&e(i.data)},function(t){_.isFunction(e)&&e(t.data)})},t.prototype.create=function(t,e,n){var i=this;this.$http.post("/ajax/api/cabinet/publications/",t).then(function(o){0===o.data.code?(i.$state.go("publication_edit",{id:t.tid+":"+o.data.data.id}),_.isFunction(e)&&e(o.data)):_.isFunction(n)&&n(o.data)},function(t){_.isFunction(n)&&n(t.data)})},t.prototype.loadPublication=function(t,e,n){var i=this;this.$http.get("/ajax/api/cabinet/publications/"+t.tid+":"+t.hid+"/").then(function(t){0===t.data.code?(console.log(t.data.data),i._publication=t.data.data,i.createDefaultTerms(),_.isFunction(e)&&e(i._publication)):_.isFunction(n)&&n(t.data)},function(t){_.isFunction(n)&&n(t.data)})},t.prototype.createDefaultTerms=function(){_.isNull(this._publication.sale_terms)&&(this._publication.sale_terms={},_.defaults(this._publication.sale_terms,{add_terms:null,currency_sid:"0",is_contract:!1,price:null,sale_type_sid:"0",transaction_sid:"0"})),_.isNull(this._publication.rent_terms)&&(this._publication.rent_terms={},_.defaults(this._publication.rent_terms,{add_terms:null,currency_sid:"0",is_contract:!1,period_sid:"1",persons_count:null,price:null,rent_type_sid:"0"}))},t.$inject=["$http","$state"],t}();t.PublicationsService=e}(e=t.cabinet||(t.cabinet={}))}(mappino||(mappino={}));var mappino;!function(t){var e;!function(t){var e=function(){function t(t,e){this.$http=t,this.$location=e}return t.prototype.createTicket=function(t,e){this.$http.post("/ajax/api/cabinet/support/tickets/",null).then(function(n){0===n.data.code?_.isFunction(t)&&t(n.data.data):_.isFunction(e)&&e(n.data)},function(t){_.isFunction(e)&&e(t.data)})},t.prototype.loadTickets=function(t,e){var n=this;this.$http.get("/ajax/api/cabinet/support/tickets/").then(function(i){0===i.data.code?(n._tickets=i.data.data,_.isFunction(t)&&t(n._tickets)):_.isFunction(e)&&e(i.data)},function(t){_.isFunction(e)&&e(t.data)})},t.prototype.loadTicketMessages=function(t,e,n){this.$http.get("/ajax/api/cabinet/support/tickets/"+t+"/messages/").then(function(t){0===t.data.code?_.isFunction(e)&&e(t.data.data):_.isFunction(n)&&n(t.data)},function(t){_.isFunction(n)&&n(t.data)})},t.prototype.sendMessage=function(t,e,n,i){this.$http.post("/ajax/api/cabinet/support/tickets/"+t+"/messages/",e).then(function(t){0===t.data.code?_.isFunction(n)&&n(t.data):_.isFunction(i)&&i(t.data)},function(t){_.isFunction(i)&&i(t.data)})},Object.defineProperty(t.prototype,"tickets",{get:function(){return this._tickets},enumerable:!0,configurable:!0}),t.$inject=["$http","$location"],t}();t.TicketsService=e}(e=t.cabinet||(t.cabinet={}))}(mappino||(mappino={}));var mappino;!function(t){var e;!function(t){var e=function(){function t(t,e,n,i,o){this.$rootScope=t,this.authService=e,this.$mdSidenav=n,this.$mdUtil=i,this.$mdMedia=o,t.loaders={base:!1,avatar:!1},e.tryLogin()}return t.prototype.toggleSidenav=function(){this.$mdMedia("sm")&&this.$mdSidenav("left-sidenav").toggle()},t.$inject=["$rootScope","AuthService","$mdSidenav","$mdUtil","$mdMedia"],t}();t.CabinetController=e}(e=t.cabinet||(t.cabinet={}))}(mappino||(mappino={}));var mappino;!function(t){var e;!function(t){var e=function(){function t(t,e,n,i){this.$scope=t,this.$rootScope=e,this.$timeout=n,this.publicationsService=i,t.briefs=[],t.new_publication={tid:0,for_sale:!0,for_rent:!1},this.loadPublications()}return t.prototype.loadPublications=function(){var t=this;this.$rootScope.loaders.base=!0,this.publicationsService.load(function(e){t.$scope.briefs=e,t.$rootScope.loaders.base=!1,console.log(e)})},t.prototype.createPublication=function(){this.publicationsService.create(this.$scope.new_publication)},t.$inject=["$scope","$rootScope","$timeout","PublicationsService"],t}();t.BriefsController=e}(e=t.cabinet||(t.cabinet={}))}(mappino||(mappino={}));var mappino;!function(t){var e;!function(t){var e=function(){function t(t,e,n,i,o){this.$scope=t,this.$rootScope=e,this.$timeout=n,this.$state=i,this.publicationsService=o,this.periodTypes=[],this.realtyTypes=[],this.currencyTypes=[],this._publication={},this._publication.tid=i.params.id.split(":")[0],this._publication.hid=i.params.id.split(":")[1],t.publication={},t.publicationTemplateUrl="/ajax/template/cabinet/publications/unpublished/"+this._publication.tid+"/",this.loadPublicationData(),t.$on("flow::fileAdded",function(t,e,n){console.log(n),t.preventDefault()})}return t.prototype.uploadPhoto=function(t,e,n){console.log(t)},t.prototype.loadPublicationData=function(){var t=this;this.$rootScope.loaders.base=!0,this.publicationsService.loadPublication(this._publication,function(e){t.$scope.publication=e,t.$rootScope.loaders.base=!1})},t.$inject=["$scope","$rootScope","$timeout","$state","PublicationsService"],t}();t.PublicationController=e}(e=t.cabinet||(t.cabinet={}))}(mappino||(mappino={}));var mappino;!function(t){var e;!function(t){var e=function(){function t(t,e,n,i){this.$scope=t,this.$rootScope=e,this.$timeout=n,this.authService=i,e.loaders.base=!0,this.initInputsChange(),i.loadProfile(function(n){t.user=n,e.loaders.base=!1})}return t.prototype.changePhoto=function(t){t.preventDefault(),angular.element("#photo-field").click()},t.prototype.initInputsChange=function(){var t=this;angular.element(".settings-page input[type='file']").bind("change",function(e){t.$rootScope.loaders.avatar=!0,t.authService.uploadAvatar(e.target.files[0],function(e){t.$rootScope.loaders.avatar=!1,t.$scope.imageFatal=1===e.code,t.$scope.imageTooLarge=2===e.code,t.$scope.ImageTooSmall=3===e.code,t.$scope.ImageUndefined=4===e.code})}),angular.element(".settings-page input[type='text'], .settings-page input[type='tel'], .settings-page input[type='email']").bind("focusout",function(e){var n=e.currentTarget.name,i=e.currentTarget.value.replace(/\s+/g," ");t.$scope.userProfileForm[n].$dirty&&("mobile_phone"!==n||"+38 (0__) __ - __ - ___"!==i&&"_"!==i[22])&&t.authService.checkProfileField({f:n,v:i},function(i){e.currentTarget.value=i,t.$scope.userProfileForm[n].$setValidity("invalid",!0),t.$scope.userProfileForm[n].$setValidity("duplicated",!0)},function(e){t.$scope.userProfileForm[n].$setValidity("invalid",2!==e.code),t.$scope.userProfileForm[n].$setValidity("duplicated",3!==e.code)})}),this.$scope.$watchCollection("user.preferences",function(e,n){if(!_.isUndefined(e)&&!_.isUndefined(n))for(var i in e)e[i]!=n[i]&&t.authService.checkProfileField({f:i,v:e[i]})})},t.$inject=["$scope","$rootScope","$timeout","AuthService"],t}();t.SettingsController=e}(e=t.cabinet||(t.cabinet={}))}(mappino||(mappino={}));var mappino;!function(t){var e;!function(t){var e=function(){function t(t,e,n,i){var o=this;this.$scope=t,this.$rootScope=e,this.$state=n,this.ticketsService=i,this._ticket={id:null,created:null,last_message:null,state_sid:null,subject:null,messages:null},t.ticket={},t.tickets=this._tickets=[],e.loaders.base=!0,t.ticketFormIsVisible=!1,i.loadTickets(function(n){o._tickets=t.tickets=n,e.loaders.base=!1})}return t.prototype.createTicket=function(){var t=this;this.ticketsService.createTicket(function(e){t._ticket.id=t.$scope.ticket.id=e.id,t.$scope.ticketFormIsVisible=!0,t.$scope.$$phase||t.$scope.$apply()})},t.prototype.sendMessage=function(){var t=this;this.$scope.ticketForm.$valid&&this.ticketsService.sendMessage(this._ticket.id,this.$scope.ticket,function(e){t.$state.go("ticket_view",{ticket_id:t._ticket.id})})},t.prototype.goToTicket=function(t){this.$state.go("ticket_view",{ticket_id:t})},t.$inject=["$scope","$rootScope","$state","TicketsService"],t}();t.SupportController=e}(e=t.cabinet||(t.cabinet={}))}(mappino||(mappino={}));var mappino;!function(t){var e;!function(t){var e=function(){function t(t,e,n,i){var o=this;this.$scope=t,this.$rootScope=e,this.$state=n,this.ticketsService=i,this._ticket={id:null,created:null,last_message:null,state_sid:null,subject:null,messages:null},t.ticket={},t.new_message={},t.ticketIsLoaded=!1,e.loaders.base=!0,t.$on("$stateChangeSuccess",function(n,a,c,r,s){i.loadTicketMessages(c.ticket_id,function(n){o._ticket.id=c.ticket_id,o._ticket.subject=n.subject,o._ticket.messages=n.messages,t.ticket=o._ticket,t.ticketIsLoaded=!0,e.loaders.base=!1})})}return t.prototype.sendMessage=function(){var t=this,e=this;this.$scope.ticketForm.$valid&&(this.$rootScope.loaders.base=!0,this.ticketsService.sendMessage(this._ticket.id,e.$scope.new_message,function(n){t.$rootScope.loaders.base=!1,e.$scope.ticket.messages.unshift({created:(new Date).getTime(),text:e.$scope.new_message.message,type_sid:0}),e.$scope.new_message.subject&&(e.$scope.ticket.subject=e.$scope.new_message.subject,e.$scope.new_message.subject=""),e.$scope.new_message.message=null,t.$scope.ticketForm.$setPristine(),t.$scope.ticketForm.$setUntouched()}))},t.$inject=["$scope","$rootScope","$state","TicketsService"],t}();t.TicketController=e}(e=t.cabinet||(t.cabinet={}))}(mappino||(mappino={}));var mappino;!function(t){var e;!function(t){"use strict";var e=angular.module("mappino.cabinet",["ngMaterial","ngCookies","ngMessages","ngFileUpload","ui.router","flow","mappino.core"]);new t.ProvidersConfigs(e),new t.RouterConfigs(e),new t.MaterialConfigs(e),new t.ApplicationConfigs(e),e.service("PublicationsService",t.PublicationsService),e.service("TicketsService",t.TicketsService),e.controller("CabinetController",t.CabinetController),e.controller("BriefsController",t.BriefsController),e.controller("PublicationController",t.PublicationController),e.controller("SettingsController",t.SettingsController),e.controller("SupportController",t.SupportController),e.controller("TicketController",t.TicketController)}(e=t.cabinet||(t.cabinet={}))}(mappino||(mappino={}));
//# sourceMappingURL=cabinet.js.map