var Mappino;!function(t){var e;!function(t){var e;!function(t){var e=function(){function t(){}return Object.defineProperty(t,"Default",{get:function(){return[{id:0,name:"other",title:"Другое"},{id:1,name:"owner_is_and_intermediary",title:"Владелец объявления - посредник"},{id:2,name:"untruthful_content",title:"Объявление содержит подозрительный контент"},{id:3,name:"photos_do_not_correspond_to_reality",title:"Фото не соответствуют реальности"}]},enumerable:!0,configurable:!0}),t}();t.ClaimReasonsValues=e}(e=t.Values||(t.Values={}))}(e=t.Core||(t.Core={}))}(Mappino||(Mappino={}));var Mappino;!function(t){var e;!function(t){var e;!function(t){var e=function(){function t(){}return Object.defineProperty(t,"Default",{get:function(){return{REMOVE_PUBLICATION:{TITLE:"Подтвердите удаление объявления",BODY:"Вы уверенны, что хотите удалить объявление?",ARIA_LABEL:"Вы уверенны, что хотите удалить объявление?",OK_BTN:"Да, удалить",CANCEL_BTN:"Отмена"},RECOVERY_PUBLICATION:{TITLE:"RECOVERY_PUBLICATION_TITLE",BODY:"RECOVERY_PUBLICATION_BODY",ARIA_LABEL:"RECOVERY_PUBLICATION_BODY",OK_BTN:"RECOVERY_PUBLICATION_OK_BTN",CANCEL_BTN:"RECOVERY_PUBLICATION_CANCEL_BTN"},DONE_EDITING_LATER_PUBLICATION:{TITLE:"Сохранение объявления",BODY:"Объявление успешно сохранено",ARIA_LABEL:"Объявление успешно сохранено",OK_BTN:"Хорошо"},EDIT_PUBLICATION:{TITLE:"Редактирование объявления",BODY:"Выбранное объявление опубликовано, для продолжения редактирования его следует снять с публикации. Вы уверенны, что хотите продолжить?",ARIA_LABEL:"Выбранное объявление опубликовано, для продолжения редактирования его следует снять с публикации. Вы уверенны, что хотите продолжить?",OK_BTN:"Да, продолжить",CANCEL_BTN:"Отмена"},ALL_MEANS_OF_COMMUNICATION_DISABLED:{TITLE:"Вы - человек-невидимка?",BODY:"Вы только что отключили все способы связи с Вами. Возможно, стоит пересмотреть настройки.",ARIA_LABEL:"Вы только что отключили все способы связи с Вами. Возможно, стоит пересмотреть настройки.",OK_BTN:"Да, спасибо"}}},enumerable:!0,configurable:!0}),t}();t.DialogsValues=e}(e=t.Values||(t.Values={}))}(e=t.Core||(t.Core={}))}(Mappino||(Mappino={}));var Mappino;!function(t){var e;!function(t){var e;!function(t){var e=function(){function t(){}return Object.defineProperty(t,"Default",{get:function(){return{PUBLICATION:{CREATE:{TITLE:"Во время создания объявления возникла ошибка"},REMOVE:{TITLE:"Во время удаления объявления возникла ошибка"},PUBLISH:{TITLE:"Во время публикации объяления возникла ошибка"},UNPUBLISH:{TITLE:"Во время обработки объяления возникла ошибка"},LOAD:{TITLE:"Во время загрузки объяления возникла ошибка"},LOAD_CONTACTS:{TITLE:"Во время загрузки контактов объяления возникла ошибка"},UPLOAD_PHOTO:{TITLE:"Во время загрузки фото возникла ошибка"},REMOVE_PHOTO:{TITLE:"Во время удаления фото возникла ошибка"},SET_TITLE_PHOTO:{TITLE:"Во время обработки фото возникла ошибка"},CHECK_FIELD:{TITLE:"Во время проверки значения поля возникла ошибка"},LOAD_BRIEFS:{TITLE:"Во время загрузки объявлений возникла ошибка"},SEND_MESSAGE:{TITLE:"Во время отправки сообщения возникла ошибка"},SEND_CALL_REQUEST:{TITLE:"Во время запроса обратного звонка возникла ошибка"},SEND_CLAIM:{TITLE:"Во время отправки жалобы возникла ошибка"},ACCEPT_MODERATING:{TITLE:"Во время подтверждения модерации возникла ошибка"},REJECT_MODERATING:{TITLE:"Во время подтверждения модерации возникла ошибка"},HOLD_MODERATING:{TITLE:"Во время отложения модерации возникла ошибка"}},TICKETS:{CREATE:{TITLE:"Во время восстания тикета возникла ошибка"},LOAD:{TITLE:"Во время загрузки сообщений возникла ошибка"},LOAD_TICKET_MESSAGES:{TITLE:"Во время загрузки сообщений возникла ошибка"},SEND_TICKET_MESSAGE:{TITLE:"Во время отправки сообщения возникла ошибка"}}}},enumerable:!0,configurable:!0}),t}();t.ToastsValues=e}(e=t.Values||(t.Values={}))}(e=t.Core||(t.Core={}))}(Mappino||(Mappino={}));var Mappino;!function(t){var e;!function(t){var e;!function(t){var e=function(){function t(){}return Object.defineProperty(t,"Default",{get:function(){return[{id:"0",name:"other",title:"Другой"},{id:"1",name:"not_defined",title:"Панель"},{id:"2",name:"not_defined",title:"Кирпич"},{id:"3",name:"not_defined",title:"Хрущевка"},{id:"4",name:"not_defined",title:"Монолит"},{id:"5",name:"not_defined",title:"Дореволюционний"},{id:"6",name:"not_defined",title:"Малосемейка"},{id:"7",name:"not_defined",title:"Индивидуальный проект"},{id:"8",name:"not_defined",title:"Неизвестно"}]},enumerable:!0,configurable:!0}),Object.defineProperty(t,"Trade",{get:function(){return[{id:"0",name:"not_defined",title:"В жилом здании"},{id:"1",name:"not_defined",title:"В торгово-развлекательном центре"},{id:"2",name:"not_defined",title:"В бизнес-центре"},{id:"3",name:"not_defined",title:"В административном здании"},{id:"4",name:"not_defined",title:"В отдельном здании"}]},enumerable:!0,configurable:!0}),t}();t.BuildingTypesValues=e}(e=t.Values||(t.Values={}))}(e=t.Core||(t.Core={}))}(Mappino||(Mappino={}));var Mappino;!function(t){var e;!function(t){var e;!function(t){var e=function(){function t(){}return Object.defineProperty(t,"Default",{get:function(){return[{id:"0",name:"not_defined",title:"Косметический ремонт"},{id:"1",name:"not_defined",title:"Жилое"},{id:"2",name:"not_defined",title:"Евроремонт"},{id:"3",name:"not_defined",title:"Дизайнерский ремонт"},{id:"4",name:"not_defined",title:"Требуется косметический ремонт"},{id:"5",name:"not_defined",title:"Неоконченный ремонт"},{id:"6",name:"not_defined",title:"Под чистовую отделку"}]},enumerable:!0,configurable:!0}),t}();t.ConditionTypesValues=e}(e=t.Values||(t.Values={}))}(e=t.Core||(t.Core={}))}(Mappino||(Mappino={}));var Mappino;!function(t){var e;!function(t){var e;!function(t){var e=function(){function t(){}return Object.defineProperty(t,"Default",{get:function(){return[{id:"0",name:"USD",title:"Дол."},{id:"1",name:"EUR",title:"Евро"},{id:"2",name:"UAH",title:"Грн."}]},enumerable:!0,configurable:!0}),t}();t.CurrencyTypesValues=e}(e=t.Values||(t.Values={}))}(e=t.Core||(t.Core={}))}(Mappino||(Mappino={}));var Mappino;!function(t){var e;!function(t){var e;!function(t){var e=function(){function t(){}return Object.defineProperty(t,"Default",{get:function(){return[{id:"0",name:"other",title:"Другой"},{id:"1",name:"not_defined",title:"Малосемейка"},{id:"2",name:"not_defined",title:"Отдельная"},{id:"3",name:"not_defined",title:"Коммунальная"},{id:"4",name:"not_defined",title:"Двухуровневая"},{id:"5",name:"not_defined",title:"Студия"}]},enumerable:!0,configurable:!0}),t}();t.FlatTypesValues=e}(e=t.Values||(t.Values={}))}(e=t.Core||(t.Core={}))}(Mappino||(Mappino={}));var Mappino;!function(t){var e;!function(t){var e;!function(t){var e=function(){function t(){}return Object.defineProperty(t,"Default",{get:function(){return[{id:"0",name:"not_defined",title:"Этаж"},{id:"1",name:"not_defined",title:"Мансарда"},{id:"2",name:"not_defined",title:"Цоколь"}]},enumerable:!0,configurable:!0}),t}();t.FloorTypesValues=e}(e=t.Values||(t.Values={}))}(e=t.Core||(t.Core={}))}(Mappino||(Mappino={}));var Mappino;!function(t){var e;!function(t){var e;!function(t){var e=function(){function t(){}return Object.defineProperty(t,"Default",{get:function(){return[{id:"0",name:"not_defined",title:"Другой"},{id:"1",name:"not_defined",title:"Индивидуальное"},{id:"2",name:"not_defined",title:"Центральное"},{id:"3",name:"not_defined",title:"Не известно"},{id:"4",name:"not_defined",title:"Отсутсвует"}]},enumerable:!0,configurable:!0}),Object.defineProperty(t,"Individual",{get:function(){return[{id:"0",name:"not_defined",title:"Другой"},{id:"1",name:"not_defined",title:"Электричество"},{id:"2",name:"not_defined",title:"Газ"},{id:"3",name:"not_defined",title:"Дрова"}]},enumerable:!0,configurable:!0}),t}();t.HeatingTypesValues=e}(e=t.Values||(t.Values={}))}(e=t.Core||(t.Core={}))}(Mappino||(Mappino={}));var Mappino;!function(t){var e;!function(t){var e;!function(t){var e=function(){function t(){}return Object.defineProperty(t,"Default",{get:function(){return[{id:"0",name:"new_building",title:"Новостройка"},{id:"1",name:"secondary_market",title:"Вторичный рынок"}]},enumerable:!0,configurable:!0}),t}();t.MarketTypesValues=e}(e=t.Values||(t.Values={}))}(e=t.Core||(t.Core={}))}(Mappino||(Mappino={}));var Mappino;!function(t){var e;!function(t){var e;!function(t){var e=function(){function t(){}return Object.defineProperty(t,"Default",{get:function(){return[{id:"0",name:"daily",title:"Посуточно"},{id:"1",name:"monthly",title:"Помесячно"},{id:"2",name:"long_term",title:"Долгосрочная"}]},enumerable:!0,configurable:!0}),t}();t.PeriodTypesValues=e}(e=t.Values||(t.Values={}))}(e=t.Core||(t.Core={}))}(Mappino||(Mappino={}));var Mappino;!function(t){var e;!function(t){var e;!function(t){var e=function(){function t(){}return Object.defineProperty(t,"Default",{get:function(){return[{id:0,name:"flat",titles:{singular:"Квартира",plural:"Квартиры",genitive:"Квартиры"},filters:["op_sid","pr_sid","p_min","p_max","cu_sid","p_c_min","p_c_max","n_b","s_m","fml","frg","r_c_min","r_c_max","t_a_min","t_a_max","f_min","f_max","msd","grd","pl_sid","lft","elt","h_w","c_w","gas","h_t_sid"]},{id:1,name:"house",titles:{singular:"Дом",plural:"Дома",genitive:"Дома"},filters:["op_sid","pr_sid","p_min","p_max","cu_sid","p_c_min","p_c_max","n_b","s_m","fml","frg","r_c_min","r_c_max","f_c_min","f_c_max","elt","h_w","gas","c_w","swg","h_t_sid"]},{id:2,name:"room",titles:{singular:"Комната",plural:"Комнаты",genitive:"Комнаты"},filters:["op_sid","pr_sid","p_min","p_max","cu_sid","p_c_min","p_c_max","n_b","s_m","fml","frg","r_c_min","r_c_max","t_a_min","t_a_max","f_min","f_max","msd","grd","lft","elt","h_w","c_w","gas","h_t_sid"]},{id:3,name:"land",titles:{singular:"Земельный участок",plural:"Земельные участки",genitive:"Земельного участка"},filters:["op_sid","p_min","p_max","cu_sid","a_min","a_max","gas","elt","wtr","swg"]},{id:4,name:"garage",titles:{singular:"Гараж",plural:"Гаражи",genitive:"Гаража"},filters:["op_sid","p_min","p_max","cu_sid","t_a_min","t_a_max"]},{id:5,name:"office",titles:{singular:"Офис",plural:"Офисы",genitive:"Офиса"},filters:["op_sid","p_min","p_max","cu_sid","n_b","s_m","t_a_min","t_a_max","c_c_min","c_c_max","sct","ktn","h_w","c_w"]},{id:6,name:"trade",titles:{singular:"Торговое помещение",plural:"Торговые помещения",genitive:"Торгового помещения"},filters:["op_sid","p_min","p_max","cu_sid","n_b","s_m","h_a_min","h_a_max","t_a_min","t_a_max","b_t_sid","gas","elt","h_w","c_w","swg"]},{id:7,name:"warehouse",titles:{singular:"Склад",plural:"Склады",genitive:"Склада"},filters:["op_sid","p_min","p_max","cu_sid","n_b","s_m","h_a_min","h_a_max","gas","elt","h_w","c_w","s_a","f_a"]}]},enumerable:!0,configurable:!0}),t}();t.RealtyTypesValues=e}(e=t.Values||(t.Values={}))}(e=t.Core||(t.Core={}))}(Mappino||(Mappino={}));var Mappino;!function(t){var e;!function(t){var e;!function(t){var e=function(){function t(){}return Object.defineProperty(t,"Default",{get:function(){return[{id:"0",name:"other",title:"Смежная"},{id:"1",name:"not_defined",title:"Раздельная"},{id:"2",name:"not_defined",title:"Раздельно-смежная"},{id:"3",name:"not_defined",title:"Свободная планировка"}]},enumerable:!0,configurable:!0}),t}();t.RoomPlanningTypesValues=e}(e=t.Values||(t.Values={}))}(e=t.Core||(t.Core={}))}(Mappino||(Mappino={}));var Mappino;!function(t){var e;!function(t){var e;!function(t){var e=angular.module("Mappino.Core.Values",[]);e.value("TXT",{DIALOGS:t.DialogsValues.Default,TOASTS:t.ToastsValues.Default}),e.value("TYPES",{BUILDING:t.BuildingTypesValues.Default,TRADE_BUILDING:t.BuildingTypesValues.Trade,CONDITION:t.ConditionTypesValues.Default,CURRENCY:t.CurrencyTypesValues.Default,FLAT:t.FlatTypesValues.Default,FLOOR:t.FloorTypesValues.Default,HEATING:t.HeatingTypesValues.Default,INDIVIDUAL_HEATING:t.HeatingTypesValues.Individual,MARKET:t.MarketTypesValues.Default,PERIOD:t.PeriodTypesValues.Default,REALTY:t.RealtyTypesValues.Default,ROOM_PLANNING:t.RoomPlanningTypesValues.Default}),e.value("CLAIM",{REASONS:t.ClaimReasonsValues.Default}),e.run(["$rootScope","CLAIM","TXT","TYPES",function(t,e,i,o){t.CLAIM=e,t.TXT=i,t.TYPES=o}])}(e=t.Values||(t.Values={}))}(e=t.Core||(t.Core={}))}(Mappino||(Mappino={}));var Mappino;!function(t){var e;!function(t){var e;!function(t){var e=function(){function t(){}return Object.defineProperty(t,"Default",{get:function(){return[{featureType:"landscape",stylers:[{hue:"#FFBB00"},{saturation:43.400000000000006},{lightness:37.599999999999994},{gamma:1}]},{featureType:"road.highway",stylers:[{hue:"#FFC200"},{saturation:-61.8},{lightness:45.599999999999994},{gamma:1}]},{featureType:"road.arterial",stylers:[{hue:"#FF0300"},{saturation:-100},{lightness:51.19999999999999},{gamma:1}]},{featureType:"road.local",stylers:[{hue:"#FF0300"},{saturation:-100},{lightness:52},{gamma:1}]},{featureType:"water",stylers:[{hue:"#0078FF"},{saturation:-13.200000000000003},{lightness:2.4000000000000057},{gamma:1}]},{featureType:"poi",stylers:[{hue:"#00FF6A"},{saturation:-1.0989010989011234},{lightness:11.200000000000017},{gamma:1}]}]},enumerable:!0,configurable:!0}),t}();t.MapStyleConstant=e}(e=t.Constants||(t.Constants={}))}(e=t.Core||(t.Core={}))}(Mappino||(Mappino={}));var Mappino;!function(t){var e;!function(t){var e;!function(t){var e=angular.module("Mappino.Core.Constants",[]);e.constant("MAP",{STYLES:t.MapStyleConstant.Default}),e.run(["$rootScope","MAP",function(t,e){t.MAP=e}])}(e=t.Constants||(t.Constants={}))}(e=t.Core||(t.Core={}))}(Mappino||(Mappino={}));var Mappino;!function(t){var e;!function(t){var e;!function(t){function e(){return{require:"ngInclude",restrict:"A",link:function(t,e,i){e.replaceWith(e.children())}}}t.includeReplace=e}(e=t.Directives||(t.Directives={}))}(e=t.Core||(t.Core={}))}(Mappino||(Mappino={}));var Mappino;!function(t){var e;!function(t){var e;!function(t){function e(){return{restrict:"A",require:"ngModel",link:function(t,e,i,o){o.$parsers.push(function(t){if(void 0===t)return"";var e=t.replace(/[^0-9]/g,"");return e!==t&&(o.$setViewValue(e),o.$render()),e})}}}t.onlyNumber=e}(e=t.Directives||(t.Directives={}))}(e=t.Core||(t.Core={}))}(Mappino||(Mappino={}));var Mappino;!function(t){var e;!function(t){var e;!function(t){function e(){return{restrict:"A",require:"ngModel",link:function(t,e,i,o){o.$parsers.push(function(t){if(void 0===t)return"";var e=t.replace(/[^0-9\.,]/g,"");return e!==t&&(o.$setViewValue(e),o.$render()),e})}}}t.onlyNumberWithDots=e}(e=t.Directives||(t.Directives={}))}(e=t.Core||(t.Core={}))}(Mappino||(Mappino={}));var Mappino;!function(t){var e;!function(t){var e;!function(t){function e(){return{restrict:"A",link:function(t,e,i){e.bind("error",function(){i.src!=i.onErrorSrc&&i.$set("src",i.onErrorSrc)})}}}t.onErrorSrc=e}(e=t.Directives||(t.Directives={}))}(e=t.Core||(t.Core={}))}(Mappino||(Mappino={}));var Mappino;!function(t){var e;!function(t){var e;!function(t){var e=angular.module("Mappino.Core.Directives",[]);e.directive("includeReplace",t.includeReplace),e.directive("onlyNumber",t.onlyNumber),e.directive("onlyNumberWithDots",t.onlyNumberWithDots),e.directive("onErrorSrc",t.onErrorSrc)}(e=t.Directives||(t.Directives={}))}(e=t.Core||(t.Core={}))}(Mappino||(Mappino={}));var Mappino;!function(t){var e;!function(t){var e;!function(t){var e=function(){function t(){this.account={first_name:null,last_name:null,full_name:null,avatar_url:null,mobile_code:"+380",mobile_phone:null,add_mobile_code:"+380",add_mobile_phone:null,landline_phone:null,add_landline_phone:null,email:null,skype:null,work_email:null},this.preferences={allow_call_requests:!0,allow_messaging:!0,hide_add_landline_phone_number:!0,hide_add_mobile_phone_number:!0,hide_email:!0,hide_landline_phone_number:!0,hide_mobile_phone_number:!0,hide_skype:!0,send_call_request_notifications_to_sid:0,send_message_notifications_to_sid:0}}return t.prototype.set=function(t){for(var e in t)t.hasOwnProperty(e)&&(angular.isDefined(this.account[e])&&(this.account[e]=t[e],("first_name"===e||"last_name"===e)&&(this.account.full_name=this.account.first_name+" "+this.account.last_name)),angular.isDefined(this.preferences[e])&&(this.preferences[e]=t[e]))},t.prototype.get=function(){return{account:this.account,preferences:this.preferences}},t}();t.User=e}(e=t.BAuth||(t.BAuth={}))}(e=t.Core||(t.Core={}))}(Mappino||(Mappino={}));var Mappino;!function(t){var e;!function(t){var e;!function(t){var e=function(){function e(e,i,o){this.$http=e,this.$cookies=i,this.Upload=o,this._user=new t.User}return e.prototype.checkPhoneNumber=function(t,e){var i=this.$http.post("/ajax/api/accounts/login/",{mobile_code:t,mobile_phone:e});return i.success(function(t){}),i.error(function(t){}),i},e.prototype.checkSMSCode=function(t,e,i){var o=this,n=this.$http.post("/ajax/api/accounts/login/check-code/",{mobile_code:t,mobile_phone:e,token:i});return n.success(function(t){o._user.set(t.data),o.$cookies.remove("mcheck")}),n.error(function(t){}),n},e.prototype.tryLogin=function(){var t=this;if(this.$cookies.get("sessionid")){var e=this.$http.get("/ajax/api/accounts/on-login-info/");return e.success(function(e){t._user.set(e.data),console.log(t._user)}),e.error(function(t){}),e}},e.prototype.loadProfile=function(){var t=this,e=this.$http.get("/ajax/api/cabinet/account/");return e.success(function(e){t._user.set(e.data.account),t._user.set(e.data.preferences)}),e.error(function(t){}),e},e.prototype.checkProfileField=function(t){var e=this,i=this.$http.post("/ajax/api/cabinet/account/",t);return i.success(function(i){e._user.set(t)}),i.error(function(t){}),i},e.prototype.uploadAvatar=function(t){var e=this,i=this.Upload.upload({url:"/ajax/api/cabinet/account/photo/",file:t});return i.success(function(t){e._user.set({avatar_url:t.data.url})}),i.error(function(t){}),i},e.prototype.removeAvatar=function(){var t=this,e=this.$http["delete"]("/ajax/api/cabinet/account/photo/");return e.success(function(e){t._user.set({avatar_url:null})}),e.error(function(t){}),e},e.prototype.logout=function(){var t=this,e=this.$http.post("/ajax/api/accounts/logout/",null);return e.success(function(e){t.$cookies.remove("sessionid")}),e.error(function(t){}),e},Object.defineProperty(e.prototype,"user",{get:function(){return this._user.get()},enumerable:!0,configurable:!0}),e.$inject=["$http","$cookies","Upload"],e}();t.BAuthService=e}(e=t.BAuth||(t.BAuth={}))}(e=t.Core||(t.Core={}))}(Mappino||(Mappino={}));var Mappino;!function(t){var e;!function(t){var e;!function(t){function e(t){return{restrict:"E",scope:{},template:'<div layout="row" layour-align="center center">\n                            <b-auth-user-avatar class="-mini -toolbar"></b-auth-user-avatar>\n\n                            <span ng-show="user.account.first_name && user.account.last_name" ng-cloak>[[ user.account.full_name ]]</span>\n                            <span ng-hide="user.account.first_name && user.account.last_name">Настройки</span>\n                        </div>',link:function(t,e,i){},controller:["$scope",function(e){e.user=t.user}]}}t.BAuthToolbarButtonDirective=e,e.$inject=["BAuthService"]}(e=t.BAuth||(t.BAuth={}))}(e=t.Core||(t.Core={}))}(Mappino||(Mappino={}));var Mappino;!function(t){var e;!function(t){var e;!function(t){function e(t){var e="http://localhost/mappino_static";return{restrict:"E",scope:{},template:'<div layout="row" layout-align="center center">\n                            <img ng-src="[[ user.account.avatar_url ]]" on-error-src="'+e+'/build/images/common/no-user.png"\n                                ng-show="user.account.avatar_url" />\n\n                            <img src="'+e+'/build/images/common/no-user.png" ng-hide="user.account.avatar_url"\n                                alt="[[ user.account.full_name ]]" />\n                        </div>',link:function(t,e,i){},controller:["$scope",function(e){e.user=t.user,console.log(e.user)}]}}t.BAuthUserAvatarDirective=e,e.$inject=["BAuthService"]}(e=t.BAuth||(t.BAuth={}))}(e=t.Core||(t.Core={}))}(Mappino||(Mappino={}));var Mappino;!function(t){var e;!function(t){var e;!function(t){"use strict";var e=angular.module("Mappino.Core.bAuth",["ngCookies","ngMaterial"]);e.service("BAuthService",t.BAuthService),e.directive("bAuthToolbarButton",t.BAuthToolbarButtonDirective),e.directive("bAuthUserAvatar",t.BAuthUserAvatarDirective),e.run(["BAuthService",function(t){t.tryLogin()}])}(e=t.BAuth||(t.BAuth={}))}(e=t.Core||(t.Core={}))}(Mappino||(Mappino={}));var Mappino;!function(t){var e;!function(t){angular.module("Mappino.Core",["Mappino.Core.Values","Mappino.Core.Constants","Mappino.Core.Directives","Mappino.Core.bAuth"])}(e=t.Core||(t.Core={}))}(Mappino||(Mappino={}));var Mappino;!function(t){var e;!function(t){var e;!function(t){!function(t){t[t.PUBLISHED=0]="PUBLISHED",t[t.UNPUBLISHED=1]="UNPUBLISHED",t[t.REMOVED=2]="REMOVED",t[t.BLOCKED=3]="BLOCKED"}(t.BRIEF_STATES||(t.BRIEF_STATES={}));var e=(t.BRIEF_STATES,function(){function t(t,e,i,o,n,a,r,s,c,l){this.tid=t,this.hid=e,this.created=i,this.for_rent=o,this.for_sale=n,this.photo_url=a,this.state_sid=r,this.title=s,this.description=c,this.moderator_message=l}return t}());t.Brief=e}(e=t.Users||(t.Users={}))}(e=t.Cabinet||(t.Cabinet={}))}(Mappino||(Mappino={}));var Mappino;!function(t){var e;!function(t){var e;!function(t){var e=function(){function t(t,e,i,o,n,a){this.id=t,this.created=e,this.state_sid=i,this.subject=o,this.last_message=n,this.messages=a}return t}();t.Ticket=e;var i=function(){function t(t,e,i){this.text=t,this.type_sid=e,this.created=i}return t}();t.TicketMessage=i}(e=t.Users||(t.Users={}))}(e=t.Cabinet||(t.Cabinet={}))}(Mappino||(Mappino={}));var Mappino;!function(t){var e;!function(t){var e;!function(t){"use strict";var e=function(){function t(t){this.app=t,t.config(["$interpolateProvider","$locationProvider",function(t,e){t.startSymbol("[["),t.endSymbol("]]")}])}return t}();t.ProvidersConfigs=e}(e=t.Users||(t.Users={}))}(e=t.Cabinet||(t.Cabinet={}))}(Mappino||(Mappino={}));var Mappino;!function(t){var e;!function(t){var e;!function(t){"use strict";var e=function(){function t(t){this.app=t,t.config(["$stateProvider","$urlRouterProvider","$locationProvider",function(t,e,i){e.otherwise("/publications/"),t.state("publications",{url:"/publications/",templateUrl:"/ajax/template/cabinet/publications/briefs/"}).state("publication_view",{url:"/publication/:id/view/",templateUrl:"/ajax/template/cabinet/publications/publication/"}).state("publication_edit",{url:"/publication/:id/edit/",templateUrl:"/ajax/template/cabinet/publications/publication/"}).state("support",{url:"/support/",templateUrl:"/ajax/template/cabinet/support/"}).state("ticket_view",{url:"/support/:ticket_id",templateUrl:"/ajax/template/cabinet/support/ticket/"}).state("settings",{url:"/settings/",templateUrl:"/ajax/template/cabinet/settings/"}),i.hashPrefix("!")}])}return t}();t.RouterConfigs=e}(e=t.Users||(t.Users={}))}(e=t.Cabinet||(t.Cabinet={}))}(Mappino||(Mappino={}));var Mappino;!function(t){var e;!function(t){var e;!function(t){"use strict";var e=function(){function t(t){this.app=t,t.config(["$mdThemingProvider",function(t){t.theme("default").primaryPalette("blue").accentPalette("deep-orange")}])}return t}();t.MaterialConfigs=e}(e=t.Users||(t.Users={}))}(e=t.Cabinet||(t.Cabinet={}))}(Mappino||(Mappino={}));var Mappino;!function(t){var e;!function(t){var e;!function(t){"use strict";var e=function(){function t(t){this.app=t}return t}();t.ApplicationConfigs=e}(e=t.Users||(t.Users={}))}(e=t.Cabinet||(t.Cabinet={}))}(Mappino||(Mappino={}));var Mappino;!function(t){var e;!function(t){var e;!function(t){var e=function(){function e(t,e,i,o,n){this.$http=t,this.$state=e,this.$mdToast=i,this.Upload=o,this.TXT=n,this._briefs=[],this.toastOptions={position:"top right",delay:5e3}}return e.prototype.create=function(t){var e=this,i=this.$http.post("/ajax/api/cabinet/publications/",t);return i.success(function(t){}),i.error(function(t){e.$mdToast.show(e.$mdToast.simple().content(e.TXT.TOASTS.PUBLICATION.CREATE.TITLE).position(e.toastOptions.position).hideDelay(e.toastOptions.delay))}),i},e.prototype.remove=function(t){var e=this,i=this.$http["delete"]("/ajax/api/cabinet/publications/"+t.tid+":"+t.hid+"/");return i.success(function(t){}),i.error(function(t){e.$mdToast.show(e.$mdToast.simple().content(e.TXT.TOASTS.PUBLICATION.REMOVE.TITLE).position(e.toastOptions.position).hideDelay(e.toastOptions.delay))}),i},e.prototype.publish=function(t){var e=this,i=this.$http.put("/ajax/api/cabinet/publications/"+t.tid+":"+t.hid+"/publish/",null);return i.success(function(t){}),i.error(function(t){e.$mdToast.show(e.$mdToast.simple().content(e.TXT.TOASTS.PUBLICATION.PUBLISH.TITLE).position(e.toastOptions.position).hideDelay(e.toastOptions.delay))}),i},e.prototype.unpublish=function(t){var e=this,i=this.$http.put("/ajax/api/cabinet/publications/"+t.tid+":"+t.hid+"/unpublish/",null);return i.success(function(t){}),i.error(function(t){e.$mdToast.show(e.$mdToast.simple().content(e.TXT.TOASTS.PUBLICATION.UNPUBLISH.TITLE).position(e.toastOptions.position).hideDelay(e.toastOptions.delay))}),i},e.prototype.load=function(t){var e=this,i=this.$http.get("/ajax/api/cabinet/publications/"+t.tid+":"+t.hid+"/");return i.success(function(t){e.publication=t.data}),i.error(function(t){e.$mdToast.show(e.$mdToast.simple().content(e.TXT.TOASTS.PUBLICATION.LOAD.TITLE).position(e.toastOptions.position).hideDelay(e.toastOptions.delay))}),i},e.prototype.uploadPhoto=function(t,e){var i=this,o=this.Upload.upload({url:"/ajax/api/cabinet/publications/"+t.tid+":"+t.hid+"/photos/",file:e});return o.success(function(t){i.publication.photos||(i.publication.photos=[]),i.publication.photos.push(t.data)}),o.error(function(t){i.$mdToast.show(i.$mdToast.simple().content(i.TXT.TOASTS.PUBLICATION.UPLOAD_PHOTO.TITLE).position(i.toastOptions.position).hideDelay(i.toastOptions.delay))}),o},e.prototype.removePhoto=function(t,e){var i=this,o=this.$http["delete"]("/ajax/api/cabinet/publications/"+t.tid+":"+t.hid+"/photos/"+e+"/");return o.success(function(t){for(var o=i.publication.photos,n=0,a=o.length;a>n;n++){var r=o[n];r&&r.hash_id==e&&i.publication.photos.splice(n,1)}for(var n=0,a=o.length;a>n;n++){var r=o[n];r&&r.hash_id==t.data.hash_id&&(r.is_title=!0)}}),o.error(function(t){i.$mdToast.show(i.$mdToast.simple().content(i.TXT.TOASTS.PUBLICATION.REMOVE_PHOTO.TITLE).position(i.toastOptions.position).hideDelay(i.toastOptions.delay))}),o},e.prototype.setTitlePhoto=function(t,e){var i=this,o=this.$http.put("/ajax/api/cabinet/publications/"+t.tid+":"+t.hid+"/photos/"+e+"/title/",null);return o.success(function(t){for(var o=i.publication.photos,n=0,a=o.length;a>n;n++){var r=o[n];r.is_title=r.hash_id===e?!0:!1}}),o.error(function(t){i.$mdToast.show(i.$mdToast.simple().content(i.TXT.TOASTS.PUBLICATION.SET_TITLE_PHOTO.TITLE).position(i.toastOptions.position).hideDelay(i.toastOptions.delay))}),o},e.prototype.checkField=function(t,e){var i=this,o=this.$http.put("/ajax/api/cabinet/publications/"+t.tid+":"+t.hid+"/",e);return o.success(function(t){}),o.error(function(t){i.$mdToast.show(i.$mdToast.simple().content(i.TXT.TOASTS.PUBLICATION.CHECK_FIELD.TITLE).position(i.toastOptions.position).hideDelay(i.toastOptions.delay))}),o},e.prototype.loadBriefs=function(){var e=this,i=this.$http.get("/ajax/api/cabinet/publications/briefs/all/");return i.success(function(i){for(var o=0,n=i.data.length;n>o;o++){var a=i.data[o];e._briefs.push(new t.Brief(a.tid,a.hid,a.created,a.for_rent,a.for_sale,a.photo_url,a.state_sid,a.title,a.description,a.moderator_message))}}),i.error(function(t){e.$mdToast.show(e.$mdToast.simple().content(e.TXT.TOASTS.PUBLICATION.LOAD_BRIEFS.TITLE).position(e.toastOptions.position).hideDelay(e.toastOptions.delay))}),i},Object.defineProperty(e.prototype,"briefs",{get:function(){return this._briefs},enumerable:!0,configurable:!0}),e.$inject=["$http","$state","$mdToast","Upload","TXT"],e}();t.PublicationsService=e}(e=t.Users||(t.Users={}))}(e=t.Cabinet||(t.Cabinet={}))}(Mappino||(Mappino={}));var Mappino;!function(t){var e;!function(t){var e;!function(t){var e=function(){function e(t,e,i){this.$http=t,this.$mdToast=e,this.TXT=i,this.toastOptions={position:"top right",delay:5e3}}return e.prototype.create=function(){var t=this,e=this.$http.post("/ajax/api/cabinet/support/tickets/",null);return e.success(function(t){}),e.error(function(e){t.$mdToast.show(t.$mdToast.simple().content(t.TXT.TOASTS.TICKETS.CREATE.TITLE).position(t.toastOptions.position).hideDelay(t.toastOptions.delay))}),e},e.prototype.load=function(){var e=this,i=this.$http.get("/ajax/api/cabinet/support/tickets/");return i.success(function(i){for(var o=i.data,n=0,a=o.length;a>n;n++){var r=o[n];e._tickets.push(new t.Ticket(r.id,r.created,r.state_sid,r.subject,r.last_message))}}),i.error(function(t){e.$mdToast.show(e.$mdToast.simple().content(e.TXT.TOASTS.TICKETS.LOAD.TITLE).position(e.toastOptions.position).hideDelay(e.toastOptions.delay))}),i},e.prototype.loadTicketMessages=function(e){var i=this,o=this.$http.get("/ajax/api/cabinet/support/tickets/"+e+"/messages/");return o.success(function(e){var o=e.data,n=o.messages;i._ticket=new t.Ticket(o.id,o.created,o.state_sid,o.subject,o.last_message);for(var a=0,r=n.length;r>a;a++){var s=n[a];i._ticket.messages.push(new t.TicketMessage(s.text,s.type_sid,s.created))}}),o.error(function(t){i.$mdToast.show(i.$mdToast.simple().content(i.TXT.TOASTS.TICKETS.LOAD_TICKET_MESSAGES.TITLE).position(i.toastOptions.position).hideDelay(i.toastOptions.delay))}),o},e.prototype.sendMessage=function(t,e){var i=this,o=this.$http.post("/ajax/api/cabinet/support/tickets/"+t+"/messages/",e);return o.success(function(t){}),o.error(function(t){i.$mdToast.show(i.$mdToast.simple().content(i.TXT.TOASTS.TICKETS.SEND_TICKET_MESSAGE.TITLE).position(i.toastOptions.position).hideDelay(i.toastOptions.delay))}),o},Object.defineProperty(e.prototype,"tickets",{get:function(){return this._tickets},enumerable:!0,configurable:!0}),e.$inject=["$http","$mdToast","TXT"],e}();t.TicketsService=e}(e=t.Users||(t.Users={}))}(e=t.Cabinet||(t.Cabinet={}))}(Mappino||(Mappino={}));var Mappino;!function(t){var e;!function(t){var e;!function(t){function e(t,e){return{restrict:"A",link:function(i,o,n,a){e(function(){var e=angular.element(t),i=angular.element("main"),n=i.find("[ui-view]"),a=angular.element(o),r=angular.element(a.parents("form").find("md-card")),s=r.first(),c=r.last(),l=n.height()-(i.height()+i.scrollTop()),u=e.width()<800?a.height():24+a.height(),p=e.width()<800?16:43;c.attr("style","margin-bottom:"+u+"px !important;"),a.css({width:s.width()+"px",bottom:0,left:s.offset().left}),l=n.height()-(i.height()+i.scrollTop()),l>=p?a.addClass("-fixed"):a.removeClass("-fixed"),e.bind("resize",function(){l=n.height()-(i.height()+i.scrollTop()),u=e.width()<800?a.height():24+a.height(),p=e.width()<800?16:43,a.css({width:s.width()+"px",left:s.offset().left}),l>=p?a.addClass("-fixed"):a.removeClass("-fixed"),e.width()<800?(a.css({right:s.offset().left}),c.attr("style","margin-bottom:"+u+"px !important;")):a.css({right:"none"})}),i.scroll(function(){l=n.height()-(i.height()+i.scrollTop()),l>=p?a.addClass("-fixed"):a.removeClass("-fixed")})},1e3)}}}t.publicationControls=e,e.$inject=["$window","$timeout"]}(e=t.Users||(t.Users={}))}(e=t.Cabinet||(t.Cabinet={}))}(Mappino||(Mappino={}));var Mappino;!function(t){var e;!function(t){var e;!function(t){var e=function(){function t(t,e,i,o,n){this.$scope=t,this.$rootScope=e,this.$mdSidenav=i,this.$mdUtil=o,this.$mdMedia=n,e.loaders={overlay:!1,navbar:!1,avatar:!1,tickets:!1}}return t.prototype.toggleSidenav=function(){this.$mdMedia("sm")&&this.$mdSidenav("left-sidenav").toggle()},t.$inject=["$scope","$rootScope","$mdSidenav","$mdUtil","$mdMedia"],t}();t.CabinetController=e}(e=t.Users||(t.Users={}))}(e=t.Cabinet||(t.Cabinet={}))}(Mappino||(Mappino={}));var Mappino;!function(t){var e;!function(t){var e;!function(t){var e=function(){function e(t,e,i,o,n,a){this.$scope=t,this.$rootScope=e,this.$mdDialog=i,this.$state=o,this.TXT=n,this.publicationsService=a,this.briefs=[],this.newPublication={tid:0,for_sale:!0,for_rent:!1},e.pageTitle="Все объявления",
t.briefs=this.briefs,t.newPublication=this.newPublication,this.loadBriefs()}return e.prototype.loadBriefs=function(){var t=this;this.$rootScope.loaders.navbar=!0,this.publicationsService.loadBriefs().success(function(e){t.$scope.briefs=t.publicationsService.briefs,t.$rootScope.loaders.navbar=!1}).error(function(e){t.$rootScope.loaders.navbar=!1})},e.prototype.removeBrief=function(e,i){var o=this,n=this.$mdDialog.confirm().parent(angular.element(document.body)).title(this.TXT.DIALOGS.REMOVE_PUBLICATION.TITLE).content(this.TXT.DIALOGS.REMOVE_PUBLICATION.BODY).ariaLabel(this.TXT.DIALOGS.REMOVE_PUBLICATION.ARIA_LABEL).ok(this.TXT.DIALOGS.REMOVE_PUBLICATION.OK_BTN).cancel(this.TXT.DIALOGS.REMOVE_PUBLICATION.CANCEL_BTN).targetEvent(e);this.$mdDialog.show(n).then(function(){o.$rootScope.loaders.overlay=!0,o.publicationsService.remove({tid:i.tid,hid:i.hid}).success(function(e){for(var n=o.$scope.briefs,a=0,r=n.length;r>a;a++){var s=n[a];s.hid==i.hid&&(s.state_sid==t.BRIEF_STATES.REMOVED?n.splice(a,1):s.state_sid=t.BRIEF_STATES.REMOVED)}o.$rootScope.loaders.overlay=!1}).error(function(t){o.$rootScope.loaders.overlay=!1})})},e.prototype.recoveryBrief=function(t,e){var i=this,o=this.$mdDialog.confirm().parent(angular.element(document.body)).title(this.TXT.DIALOGS.RECOVERY_PUBLICATION.TITLE).content(this.TXT.DIALOGS.RECOVERY_PUBLICATION.BODY).ariaLabel(this.TXT.DIALOGS.RECOVERY_PUBLICATION.ARIA_LABEL).ok(this.TXT.DIALOGS.RECOVERY_PUBLICATION.OK_BTN).cancel(this.TXT.DIALOGS.RECOVERY_PUBLICATION.CANCEL_BTN).targetEvent(t);this.$mdDialog.show(o).then(function(){i.$rootScope.loaders.overlay=!0,i.publicationsService.unpublish({tid:e.tid,hid:e.hid}).success(function(t){i.$rootScope.loaders.overlay=!1,i.$state.go("publication_edit",{id:e.tid+":"+e.hid})}).error(function(t){i.$rootScope.loaders.overlay=!1})})},e.prototype.editPublication=function(e,i){var o=this,n=this.$mdDialog.confirm().parent(angular.element(document.body)).title(this.TXT.DIALOGS.EDIT_PUBLICATION.TITLE).content(this.TXT.DIALOGS.EDIT_PUBLICATION.BODY).ariaLabel(this.TXT.DIALOGS.EDIT_PUBLICATION.ARIA_LABEL).ok(this.TXT.DIALOGS.EDIT_PUBLICATION.OK_BTN).cancel(this.TXT.DIALOGS.EDIT_PUBLICATION.CANCEL_BTN).targetEvent(e);i.state_sid==t.BRIEF_STATES.PUBLISHED?this.$mdDialog.show(n).then(function(){o.$rootScope.loaders.overlay=!0,o.publicationsService.unpublish({tid:i.tid,hid:i.hid}).success(function(t){o.$rootScope.loaders.overlay=!1,o.$state.go("publication_edit",{id:i.tid+":"+i.hid})}).error(function(t){o.$rootScope.loaders.overlay=!1})}):this.$state.go("publication_edit",{id:i.tid+":"+i.hid})},e.prototype.createPublication=function(){var t=this,e=this.$scope.newPublication;this.$rootScope.loaders.overlay=!0,this.publicationsService.create(e).success(function(i){t.$rootScope.loaders.overlay=!1,t.$state.go("publication_edit",{id:e.tid+":"+i.data.hid})}).error(function(e){t.$rootScope.loaders.overlay=!1})},e.$inject=["$scope","$rootScope","$mdDialog","$state","TXT","PublicationsService"],e}();t.BriefsController=e}(e=t.Users||(t.Users={}))}(e=t.Cabinet||(t.Cabinet={}))}(Mappino||(Mappino={}));var Mappino;!function(t){var e;!function(t){var e;!function(t){var e=function(){function t(t,e,i,o,n,a,r,s){this.$scope=t,this.$rootScope=e,this.$state=i,this.$timeout=o,this.$mdDialog=n,this.TXT=a,this.MAP=r,this.publicationsService=s,this.tempPublicationPhotos=[],this.publicationIds={tid:null,hid:null},e.pageTitle="Редактирование объявления",this.publicationIds.tid=i.params.id.split(":")[0],this.publicationIds.hid=i.params.id.split(":")[1],i.is("publication_view")?t.publicationTemplateUrl="/ajax/template/cabinet/publications/published/"+this.publicationIds.tid+"/":(t.publicationTemplateUrl="/ajax/template/cabinet/publications/unpublished/"+this.publicationIds.tid+"/",t.tempPublicationPhotos=this.tempPublicationPhotos,t.publicationPhotoLoader={},t.forms={},t.publicationPhotosErrors={minimumPhotos:!1,photoTooSmall:!1,photoTooLarge:!1}),t.publication=this.publication,this.loadPublicationData()}return t.prototype.loadPublicationData=function(){var t=this;this.$rootScope.loaders.overlay=!0,this.publicationsService.load(this.publicationIds).success(function(e){t.$scope.publication=e.data,t.$rootScope.loaders.overlay=!1,t.$state.is("publication_edit")&&(t.initMap(),t.initInputsChange())}).error(function(e){t.$rootScope.loaders.overlay=!1})},t.prototype.removePublication=function(t){var e=this,i=this.$mdDialog.confirm().parent(angular.element(document.body)).title(this.TXT.DIALOGS.REMOVE_PUBLICATION.TITLE).content(this.TXT.DIALOGS.REMOVE_PUBLICATION.BODY).ariaLabel(this.TXT.DIALOGS.REMOVE_PUBLICATION.ARIA_LABEL).ok(this.TXT.DIALOGS.REMOVE_PUBLICATION.OK_BTN).cancel(this.TXT.DIALOGS.REMOVE_PUBLICATION.CANCEL_BTN).targetEvent(t);this.$mdDialog.show(i).then(function(){e.$rootScope.loaders.overlay=!0,e.publicationsService.remove(e.publicationIds).success(function(t){e.$rootScope.loaders.overlay=!1,e.$state.go("publications")}).error(function(t){e.$rootScope.loaders.overlay=!1})})},t.prototype.publishPublication=function(t){var e=this;if(this.$scope.forms.publicationForm.$invalid){var i=angular.element("input[type='checkbox'].ng-invalid")[0],o=angular.element("textarea.ng-invalid, input.ng-invalid")[0];i?i.parentNode.scrollIntoView(!0):(o.parentNode.scrollIntoView(!0),o.focus())}else this.$scope.publication.photos&&this.$scope.publication.photos.length?(this.$rootScope.loaders.overlay=!0,this.publicationsService.publish(this.publicationIds).success(function(t){e.$rootScope.loaders.overlay=!1,e.$state.go("publications")}).error(function(t){3==t.code&&(e.$scope.publicationPhotosErrors.minimumPhotos=!0),e.$rootScope.loaders.overlay=!1})):this.scrollToBottom()},t.prototype.doneEditingLaterPublication=function(t){var e=this,i=this.$mdDialog.alert().parent(angular.element(document.body)).clickOutsideToClose(!1).title(this.TXT.DIALOGS.DONE_EDITING_LATER_PUBLICATION.TITLE).content(this.TXT.DIALOGS.DONE_EDITING_LATER_PUBLICATION.BODY).ariaLabel(this.TXT.DIALOGS.DONE_EDITING_LATER_PUBLICATION.ARIA_LABEL).ok(this.TXT.DIALOGS.DONE_EDITING_LATER_PUBLICATION.OK_BTN).targetEvent(t);this.$mdDialog.show(i).then(function(){e.$state.go("publications")})},t.prototype.uploadPublicationPhotos=function(t){var e=this;if(t&&t.length)for(var i=0;i<t.length;i++){var o=t[i];this.$scope.tempPublicationPhotos.push({}),this.scrollToBottom(),this.publicationsService.uploadPhoto(this.publicationIds,o).success(function(t){e.$scope.tempPublicationPhotos.shift(),e.scrollToBottom()}).error(function(t){e.$scope.tempPublicationPhotos.shift(),4==t.code&&(e.$scope.publicationPhotosErrors.photoTooLarge=!0),5==t.code&&(e.$scope.publicationPhotosErrors.photoTooSmall=!0)})}this.$scope.publicationPhotosErrors.minimumPhotos=!1,this.$scope.publicationPhotosErrors.photoTooSmall=!1,this.$scope.publicationPhotosErrors.photoTooLarge=!1},t.prototype.removePublicationPhoto=function(t){var e=this;this.$scope.publicationPhotoLoader[t]=!0,this.publicationsService.removePhoto(this.publicationIds,t).success(function(i){e.$scope.publicationPhotoLoader[t]=!1})},t.prototype.setTitlePhoto=function(t){var e=this;this.$scope.publicationPhotoLoader[t]=!0,this.publicationsService.setTitlePhoto(this.publicationIds,t).success(function(i){e.$scope.publicationPhotoLoader[t]=!1})},t.prototype.initMap=function(){var t=this;this.$timeout(function(){var e=new google.maps.LatLng(t.$scope.publication.head.lat||50.448159,t.$scope.publication.head.lng||30.524654),i={center:e,zoom:t.$scope.publication.head.lat?17:8,mapTypeId:google.maps.MapTypeId.ROADMAP,mapTypeControl:!1,streetViewControl:!1,scrollwheel:!0,disableDoubleClickZoom:!1,styles:t.MAP.STYLES},o={componentRestrictions:{country:"ua"}};t.placeAutocompleteField=document.getElementById("publication-map-input"),t.placeAutocomplete=new google.maps.places.Autocomplete(t.placeAutocompleteField,o),t.map=new google.maps.Map(document.getElementById("publication-map"),i),t.marker=new google.maps.Marker({map:t.map,draggable:!0,position:e}),t.placeAutocomplete.bindTo("bounds",t.map),google.maps.event.addListener(t.map,"click",function(e){t.marker.setPosition(e.latLng),t.setAddressFromLatLng(e.latLng,t.placeAutocompleteField)}),google.maps.event.addListener(t.marker,"dragend",function(e){t.setAddressFromLatLng(e.latLng,t.placeAutocompleteField)}),google.maps.event.addListener(t.placeAutocomplete,"place_changed",function(){var e=t.placeAutocomplete.getPlace();e.geometry&&(e.geometry.viewport?t.map.fitBounds(e.geometry.viewport):(t.map.panTo(e.geometry.location),t.marker.setPosition(e.geometry.location),t.map.setZoom(17),t.setAddressFromLatLng(e.geometry.location,t.placeAutocompleteField)))}),google.maps.event.addListenerOnce(t.map,"idle",function(e){t.$timeout(function(){var e=new google.maps.LatLng(t.$scope.publication.head.lat||50.448159,t.$scope.publication.head.lng||30.524654);t.map.setCenter(e),t.publicationsService.checkField(t.publicationIds,{fieldName:"lat_lng",fieldValue:e.lat()+";"+e.lng()})},1e3)})},1e3)},t.prototype.setAddressFromLatLng=function(t,e){var i=this,o=new google.maps.Geocoder;o.geocode({latLng:t},function(o,n){n==google.maps.GeocoderStatus.OK&&angular.element(e).val(o[0].formatted_address),angular.element(e).trigger("input"),i.publicationsService.checkField(i.publicationIds,{fieldName:"address",fieldValue:e.value}),i.publicationsService.checkField(i.publicationIds,{fieldName:"lat_lng",fieldValue:t.lat()+";"+t.lng()})})},t.prototype.initInputsChange=function(){var t=this;angular.element("form[name='forms.publicationForm'] input, form[name='forms.publicationForm'] textarea").on("focusout",function(e){var i=e.currentTarget.name,o=e.currentTarget.value.replace(/\s+/g," ");t.$scope.forms.publicationForm[i].$dirty&&t.publicationsService.checkField(t.publicationIds,{fieldName:i,fieldValue:o}).success(function(n){n.data&&!angular.element(e.currentTarget).is(":focus")&&(e.currentTarget.value=n.data.value?n.data.value:o),t.$scope.forms.publicationForm[i].$setValidity("invalid",!0)}).error(function(e){t.$scope.forms.publicationForm[i].$setValidity("invalid",0===e.code)})}),angular.element(".publication-view-container input[type='checkbox']").bind("change",function(t){var e=t.currentTarget.name,i=t.currentTarget.checked;this.publicationsService.checkField(this.publicationIds,{fieldName:e,fieldValue:i})})},t.prototype.checkField=function(t){var e=null;this.validatePublicationOperation(),-1!==t.indexOf("rent_")?(e=this.$scope.publication.rent_terms[t.replace("rent_","")],this.publicationsService.checkField(this.publicationIds,{fieldName:t,fieldValue:e})):-1!==t.indexOf("sale_")?(e=this.$scope.publication.sale_terms[t.replace("sale_","")],this.publicationsService.checkField(this.publicationIds,{fieldName:t,fieldValue:e})):angular.isUndefined(this.$scope.publication.head[t])?angular.isUndefined(this.$scope.publication.body[t])?angular.isUndefined(this.$scope.publication.rent_terms[t])?angular.isUndefined(this.$scope.publication.sale_terms[t])||(e=this.$scope.publication.sale_terms[t],this.publicationsService.checkField(this.publicationIds,{fieldName:t,fieldValue:e})):(e=this.$scope.publication.rent_terms[t],this.publicationsService.checkField(this.publicationIds,{fieldName:t,fieldValue:e})):(e=this.$scope.publication.body[t],this.publicationsService.checkField(this.publicationIds,{fieldName:t,fieldValue:e})):(e=this.$scope.publication.head[t],this.publicationsService.checkField(this.publicationIds,{fieldName:t,fieldValue:e}))},t.prototype.validatePublicationOperation=function(){0==this.$scope.publication.head.for_sale&&0==this.$scope.publication.head.for_rent&&(this.$scope.publication.head.for_sale=!0,this.checkField("for_sale"))},t.prototype.scrollToBottom=function(){angular.element("main").animate({scrollTop:angular.element("main [ui-view]").height()},"slow")},t.$inject=["$scope","$rootScope","$state","$timeout","$mdDialog","TXT","MAP","PublicationsService"],t}();t.PublicationController=e}(e=t.Users||(t.Users={}))}(e=t.Cabinet||(t.Cabinet={}))}(Mappino||(Mappino={}));var Mappino;!function(t){var e;!function(t){var e;!function(t){var e=function(){function t(t,e,i,o,n,a){var r=this;this.$scope=t,this.$rootScope=e,this.$timeout=i,this.$mdDialog=o,this.bAuthService=n,this.TXT=a,e.pageTitle="Редактирование профиля",t.profile={account:{},preferences:{}},e.loaders.overlay=!0,n.loadProfile().success(function(i){t.profile.account=i.data.account,t.profile.preferences=i.data.preferences,console.log(t.profile),r.initInputsChange(),e.loaders.overlay=!1}).error(function(t){})}return t.prototype.changeAvatar=function(t){var e=this;t.length&&(this.$rootScope.loaders.avatar=!0,this.bAuthService.uploadAvatar(t).success(function(t){e.$rootScope.loaders.avatar=!1,e.$scope.profile.account.avatar_url=e.bAuthService.user.account.avatar_url,e.$scope.imageFatal=1===t.code,e.$scope.imageTooLarge=2===t.code,e.$scope.ImageTooSmall=3===t.code,e.$scope.ImageUndefined=4===t.code}).error(function(t){}))},t.prototype.removeAvatar=function(){var t=this;this.$rootScope.loaders.avatar=!0,this.bAuthService.removeAvatar().success(function(e){t.$rootScope.loaders.avatar=!1,t.$scope.profile.account.avatar_url=null}).error(function(t){})},t.prototype.initInputsChange=function(){var t=this;angular.element(".settings-page input[type='text'], .settings-page input[type='tel'], .settings-page input[type='email']").bind("focusout",function(e){var i=e.currentTarget.name,o=e.currentTarget.value.replace(/\s+/g," ");if(t.$scope.userProfileForm[i].$dirty){t.bAuthService.checkProfileField((n={},n[i]=o,n)).success(function(o){e.currentTarget.value=o.data,t.$scope.userProfileForm[i].$setValidity("invalid",2!==o.code),t.$scope.userProfileForm[i].$setValidity("duplicated",3!==o.code)}).error(function(t){});var n}}),this.$scope.$watchCollection("profile.preferences",function(e,i){if(!angular.isUndefined(e)&&!angular.isUndefined(i))for(var o in e)e.hasOwnProperty(o)&&e[o]!=i[o]&&t.bAuthService.checkProfileField((n={},n[o]=e[o],n));t.checkIfAllMeansOfCommunicationDisabled();var n})},t.prototype.checkIfAllMeansOfCommunicationDisabled=function(){if(this.$scope.profile.account&&this.$scope.profile.preferences&&this.$scope.profile.preferences.hide_email&&this.$scope.profile.preferences.hide_mobile_phone_number&&this.$scope.profile.preferences.hide_add_mobile_phone_number&&this.$scope.profile.preferences.hide_landline_phone_number&&this.$scope.profile.preferences.hide_add_landline_phone_number&&this.$scope.profile.preferences.hide_skype){var t=this.$mdDialog.confirm().parent(angular.element(document.body)).title(this.TXT.DIALOGS.ALL_MEANS_OF_COMMUNICATION_DISABLED.TITLE).content(this.TXT.DIALOGS.ALL_MEANS_OF_COMMUNICATION_DISABLED.BODY).ariaLabel(this.TXT.DIALOGS.ALL_MEANS_OF_COMMUNICATION_DISABLED.ARIA_LABEL).ok(this.TXT.DIALOGS.ALL_MEANS_OF_COMMUNICATION_DISABLED.OK_BTN);this.$mdDialog.show(t)}},t.$inject=["$scope","$rootScope","$timeout","$mdDialog","BAuthService","TXT"],t}();t.SettingsController=e}(e=t.Users||(t.Users={}))}(e=t.Cabinet||(t.Cabinet={}))}(Mappino||(Mappino={}));var Mappino;!function(t){var e;!function(t){var e;!function(t){var e=function(){function t(t,e,i,o){this.$scope=t,this.$rootScope=e,this.$state=i,this.ticketsService=o,this.ticket={ticket_id:null,created:null,last_message:null,state_sid:null,subject:null,messages:null},e.pageTitle="Поддержка mappino",t.ticket=this.ticket,t.tickets=this.tickets=[],e.loaders.tickets=!0,t.ticketFormIsVisible=!1,o.load().success(function(i){t.tickets=o.tickets,console.log(t.tickets),e.loaders.tickets=!1})}return t.prototype.createTicket=function(){var t=this;this.ticketsService.create().success(function(e){t.$scope.ticket.ticket_id=e.data.id,t.$scope.ticketFormIsVisible=!0,t.$scope.$$phase||t.$scope.$apply()})},t.prototype.sendMessage=function(){var t=this;this.$scope.ticketForm.$valid&&(this.$rootScope.loaders.overlay=!0,this.ticketsService.sendMessage(this.ticket.ticket_id,this.$scope.ticket).success(function(e){t.$rootScope.loaders.overlay=!1,t.$state.go("ticket_view",{ticket_id:t.ticket.ticket_id})}))},t.prototype.goToTicket=function(t){this.$state.go("ticket_view",{ticket_id:t})},t.$inject=["$scope","$rootScope","$state","TicketsService"],t}();t.SupportController=e}(e=t.Users||(t.Users={}))}(e=t.Cabinet||(t.Cabinet={}))}(Mappino||(Mappino={}));var Mappino;!function(t){var e;!function(t){var e;!function(t){var e=function(){function t(t,e,i){var o=this;this.$scope=t,this.$rootScope=e,this.ticketsService=i,e.pageTitle="Обращение в службу поддержки mappino",t.ticket=this.ticket={ticket_id:null,created:null,last_message:null,state_sid:null,subject:null,messages:null},t.new_message={},t.ticketIsLoaded=!1,e.loaders.overlay=!0,t.$on("$stateChangeSuccess",function(n,a,r,s,c){i.loadTicketMessages(r.ticket_id).success(function(i){t.ticket.ticket_id=r.ticket_id,t.ticket.subject=i.data.subject,t.ticket.messages=i.data.messages,t.ticket=o.ticket,t.ticketIsLoaded=!0,e.loaders.overlay=!1})})}return t.prototype.sendMessage=function(){var t=this;this.$scope.ticketForm.$valid&&(this.$rootScope.loaders.overlay=!0,this.ticketsService.sendMessage(this.ticket.ticket_id,this.$scope.new_message).success(function(e){t.$rootScope.loaders.overlay=!1,t.ticket.messages.unshift({created:(new Date).getTime().toString(),text:t.$scope.new_message.message,type_sid:0}),t.$scope.new_message.subject&&(t.$scope.ticket.subject=t.$scope.new_message.subject,t.$scope.new_message.subject=""),t.$scope.new_message.message=null,t.$scope.ticketForm.$setPristine(),t.$scope.ticketForm.$setUntouched()}))},t.$inject=["$scope","$rootScope","TicketsService"],t}();t.TicketController=e}(e=t.Users||(t.Users={}))}(e=t.Cabinet||(t.Cabinet={}))}(Mappino||(Mappino={}));var Mappino;!function(t){var e;!function(t){var e;!function(t){"use strict";var e=angular.module("mappino.cabinet.users",["ngMaterial","ngCookies","ngMessages","ngFileUpload","ui.router","Mappino.Core"]);new t.ProvidersConfigs(e),new t.RouterConfigs(e),new t.MaterialConfigs(e),new t.ApplicationConfigs(e),e.service("PublicationsService",t.PublicationsService),e.service("TicketsService",t.TicketsService),e.directive("publicationControls",t.publicationControls),e.controller("CabinetController",t.CabinetController),e.controller("BriefsController",t.BriefsController),e.controller("PublicationController",t.PublicationController),e.controller("SettingsController",t.SettingsController),e.controller("SupportController",t.SupportController),e.controller("TicketController",t.TicketController)}(e=t.Users||(t.Users={}))}(e=t.Cabinet||(t.Cabinet={}))}(Mappino||(Mappino={}));
//# sourceMappingURL=cabinet.users.js.map