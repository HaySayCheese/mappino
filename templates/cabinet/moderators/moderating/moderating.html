<div class="moderating-page" layout-wrap layout-padding layout-sm="column" layout-md="column" layout-lg="column" layout-gt-lg="row"
     layout-align-md="start center" layout-align-lg="start center" layout-align-gt-lg="center start" ng-controller="ModeratingController as modCtrl">

    <md-card class="publication-card" ng-hide="loaders.overlay || !publication">
        <md-card-content>
            <div class="publication-view" layout="column">
                <div layout="column">
                    <header>
                        <ul rn-carousel rn-carousel-index="publicationPreviewSlideIndex" class="publication-preview-carousel">
                            <li ng-repeat="photo in ::publication.photos">
                                <div class="layer">
                                    <img ng-src="[[ ::photo ]]" alt=""/>
                                </div>
                            </li>
                        </ul>

                        <div class="publication-view-image-overlay">
                            <md-button class="md-icon-button slide-prev" ng-hide="publicationPreviewSlideIndex == 0"
                                       ng-click="modCtrl.prevSlide()">
                                <md-icon class="material-icons md-light md-48 md-dark-shadow">chevron_left</md-icon>
                            </md-button>
                            <md-button class="md-icon-button slide-next" ng-hide="publicationPreviewSlideIndex == publication.photos.length - 1"
                                       ng-click="modCtrl.nextSlide()">
                                <md-icon class="material-icons md-light md-48 md-dark-shadow">chevron_right</md-icon>
                            </md-button>


                            <div class="publication-view-overlay-description" layout="row" layout-align="start center" layout-padding>
                                <div layout="column" layout-padding>
                                    <div class="md-headline">
                                        [[ ::publication.title ]]
                                    </div>
                                    <div class="md-subhead">
                                        [[ ::publication.address ]]
                                    </div>
                                </div>
                            </div>
                        </div>
                    </header>

                    <div ng-include="publicationTemplateUrl"></div>

                    <!--<div layout="column" class="md-padding">-->
                        <!--<div class="md-subhead blue-text">Контакты</div>-->
                        <!--<md-divider></md-divider>-->
                        <!--<div layout="column" layout-padding>-->
                            <!--<div class="publication-contacts" layout-gt-sm="row" layout-sm="column" layout-padding>-->
                                <!--<div class="avatar" flex-sm="100" flex-gt-sm="40" layout="column" layout-align="center center">-->
                                    <!--<img ng-src="[[ publication.contacts.avatar_url ]]" alt="" on-error-src="{{ static }}build/images/common/empty-or-error-user-avatar.png"-->
                                         <!--ng-if="publication.contacts.avatar_url" />-->
                                    <!--<img src="{{ static }}build/images/common/empty-or-error-user-avatar.png" ng-if="!publication.contacts.avatar_url" alt="" />-->
                                <!--</div>-->
                                <!--<div flex-sm="100" flex-gt-sm="60" layout="column">-->
                                    <!--<div class="md-title grey-text text-darken-2" layout-padding ng-if="publication.contacts.first_name || publication.contacts.last_name">-->
                                        <!--[[ publication.contacts.first_name + '&nbsp;' ]][[ publication.contacts.last_name ]]-->
                                    <!--</div>-->
                                    <!--<div ng-if="!( publication.contacts.first_name || publication.contacts.last_name )">Продавец не указал имени.</div>-->

                                    <!--<div layout="row">-->
                                        <!--<div class="inset" ng-if="publication.contacts.mobile_phone" flex="50">-->
                                            <!--<div class="md-caption">Моб. телефон:</div>-->
                                            <!--<a ng-href="tel:[[ publication.contacts.mobile_phone ]]">-->
                                                <!--[[ publication.contacts.mobile_phone ]]-->
                                            <!--</a>-->
                                        <!--</div>-->
                                        <!--<div class="inset" ng-if="publication.contacts.add_mobile_phone" flex="50">-->
                                            <!--<div class="md-caption">Доп. моб. телефон:</div>-->
                                            <!--<a ng-href="tel:[[ publication.contacts.add_mobile_phone ]]">-->
                                                <!--[[ publication.contacts.add_mobile_phone ]]-->
                                            <!--</a>-->
                                        <!--</div>-->
                                    <!--</div>-->
                                    <!--<div layout="row">-->
                                        <!--<div class="inset" ng-if="publication.contacts.landline_phone" flex="50">-->
                                            <!--<div class="md-caption">Раб. телефон:</div>-->
                                            <!--[[ publication.contacts.landline_phone ]]-->
                                        <!--</div>-->
                                        <!--<div class="inset" ng-if="publication.contacts.add_landline_phone" flex="50">-->
                                            <!--<div class="md-caption">Доп. раб. телефон:</div>-->
                                            <!--[[ publication.contacts.add_landline_phone ]]-->
                                        <!--</div>-->
                                    <!--</div>-->
                                    <!--<div class="inset" ng-if="publication.contacts.email">-->
                                        <!--<div class="md-caption">E-mail:</div>-->
                                        <!--<a ng-href="mailto:[[ publication.contacts.email ]]">[[ publication.contacts.email ]]</a>-->
                                    <!--</div>-->
                                    <!--<div class="inset" ng-if="publication.contacts.skype">-->
                                        <!--<div class="md-caption">Skype:</div>-->
                                        <!--<a ng-href="skype:[[ publication.contacts.skype ]]?call">[[ publication.contacts.skype ]]</a>-->
                                    <!--</div>-->
                                <!--</div>-->
                            <!--</div>-->
                        <!--</div>-->
                    <!--</div>-->


                    <form class="md-padding" name="rejectReasonForm" layout="column" novalidate ng-show="rejectFormIsVisible">
                        <md-divider></md-divider>
                        <div layout="row">
                            <md-input-container flex>
                                <label>Причина блокировки</label>
                                <input type="text" name="reject_reason" ng-model="moderator.rejectReason" required>
                                <div ng-messages="rejectReasonForm.reject_reason.$error" ng-show="rejectReasonForm.reject_reason.$touched">
                                    <div ng-message="required">Обязательное поле</div>
                                </div>
                            </md-input-container>
                        </div>
                        <div layout="row">
                            <md-button class="md-primary" flex ng-click="modCtrl.toggleRejectForm()">
                                Отмена
                            </md-button>
                            <md-button class="md-raised md-primary" flex ng-click="modCtrl.rejectPublication()">
                                Отправить
                            </md-button>
                        </div>
                    </form>
                </div>
            </div>
        </md-card-content>
        <md-divider></md-divider>
        <div class="md-actions" layout="row">
            <md-button class="md-warn md-hue-3" ng-click="modCtrl.toggleRejectForm()">
                Отклонить
            </md-button>
            <md-button class="md-primary md-hue-1" ng-click="modCtrl.holdPublication()">
                Отложить
            </md-button>
            <span flex></span>
            <md-button class="md-primary md-hue-1" ng-click="modCtrl.acceptPublication()">
                Проверено
            </md-button>
        </div>
    </md-card>


    <div ng-hide="loaders.overlay || !publication.claims">
        <md-card ng-repeat="claim in publication.claims">
            <md-card-content layout="column">
                <div class="md-caption" layout="row" layout-padding>
                    <span>Создано: [[ ::claim.date_reported | date:'dd.MM.yyyy в HH:mm' ]]</span>
                    <span flex></span>
                    <span>[[ ::claim.email ]]</span>
                </div>
                <div class="md-body-1" layout="row" layout-align="start center" layout-padding>
                    <span class="md-body-2">Жалоба:&nbsp;</span>
                    [[ ::claim.message ]]
                </div>
                <div class="md-body-1" layout="row" layout-align="start center" layout-padding ng-show="claim.moderator_notice">
                    <span>Последняя заметка:&nbsp;</span>
                    [[ claim.moderator_notice ]]
                </div>
                <md-divider></md-divider>
                <div class="md-caption" layout="row" layout-padding ng-if="claim.date_closed">
                    <span>Обработано: [[ ::claim.date_closed | date:'dd.MM.yyyy в HH:mm' ]]</span>
                    <span flex></span>
                    <span>Модератор: [[ ::claim.moderator_name ]]</span>
                </div>
                <div layout="row" ng-if="!claim.date_closed">
                    <md-input-container flex>
                        <label>Заметка к жалобе (видима только модераторам)</label>
                        <input type="text" name="claim_notice" ng-model="claim.moderatorNotice">
                    </md-input-container>
                    <md-button class="md-fab md-primary" ng-disabled="!claim.moderatorNotice" ng-click="modCtrl.sendNotice(claim)">
                        <md-icon>send</md-icon>
                        <md-tooltip md-direction="top" md-delay="0">
                            Добавить заметку
                        </md-tooltip>
                    </md-button>
                    <md-button class="md-fab md-primary" ng-click="modCtrl.closeClaim(claim)">
                        <md-icon>check</md-icon>
                        <md-tooltip md-direction="top" md-delay="0">
                            Закрыть жалобу
                        </md-tooltip>
                    </md-button>
                </div>
            </md-card-content>
        </md-card>
    </div>

    <div layout="column" layout-align="center center">
        <md-card>
            <md-card-content>
                <div layout="row" layout-align="center center">
                    <md-button ng-click="modCtrl.banUser()" class="md-raised md-primary red white-text">
                        Заблокировать
                    </md-button>

                    <md-button ng-click="modCtrl.addSuspiciousUser()" class="md-raised md-primary red white-text">
                        Заподозрить -_-
                    </md-button>
                </div>
            </md-card-content>
        </md-card>
    </div>


    <md-card ng-show="!loaders.overlay && publication == null">
        <md-card-content class="center-align">
            Объявлений для модерации нету. Nach laufen gehen :)
        </md-card-content>
    </md-card>
</div>