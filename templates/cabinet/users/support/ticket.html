<div class="ticket-page" layout="column" layout-align="start center" ng-controller="TicketController as ticketCtrl">
    <md-card ng-show="ticketIsLoaded">
        <md-card-content>
            <form name="ticketForm" ng-submit="ticketCtrl.sendMessage()" novalidate>
                <div layout="row">
                    <h3 class="md-headline blue-text" ng-show="ticket.subject">
                        Тема: [[ ticket.subject ]]
                    </h3>
                    <md-input-container flex ng-hide="ticket.subject">
                        <label>Тема обращения</label>
                        <input type="text" name="subject" ng-model="new_message.subject">
                    </md-input-container>
                </div>

                <div layout="row">
                    <md-input-container flex>
                        <label>Текст сообщение</label>
                        <textarea name="message" columns="1" ng-model="new_message.message" required></textarea>
                        <div ng-messages="ticketForm.message.$error" ng-show="ticketForm.$submitted || ticketForm.message.$touched">
                            <div ng-message="required">Укажите, пожалуйста, текст обращения.</div>
                        </div>
                    </md-input-container>

                    <md-button class="md-fab md-primary" aria-label="Отправить сообщение">
                        <md-icon>send</md-icon>
                    </md-button>
                </div>
            </form>
        </md-card-content>
    </md-card>



    <md-card class="-transparent -no-padding" ng-show="ticketIsLoaded">
        <md-card-content>
            <div layout="row" layout-align="[[ message.type_sid == '0' ? 'start' : 'end' ]] start" layout-margin ng-repeat="message in ticket.messages">
                <div class="ticket-message md-whiteframe-z2" layout="row" layout-align="start start">
                    <img class="message-avatar -user" ng-src="[[ userData.account.avatar_url ]]" alt="" ng-show="userData.account.avatar_url && message.type_sid == 0"
                         on-error-src="{{ static }}build/images/common/no-user.png" />
                    <img class="message-avatar -user" src="{{ static }}build/images/common/no-user.png" ng-hide="userData.account.avatar_url && message.type_sid == 0" alt="" />

                    <div layout="column" layout-align="space-between start" flex>
                        <div class="message-text">[[ message.text ]]</div>
                        <div class="message-created grey-text" ng-class="{ '-user': message.type_sid == '0', '-support': message.type_sid != '0' }">
                            [[ message.created | date:'dd.MM.yyyy в HH:mm' ]]
                        </div>
                    </div>

                    <img class="message-avatar -support" ng-src="[[ ticketCtrl.settingsService.user.account.avatar ]]" alt="" ng-show="message.type_sid != '0'"/>
                </div>
            </div>
        </md-card-content>
    </md-card>
</div>